diff --git a/dist/cjs/Http/Multipart.js b/dist/cjs/Http/Multipart.js
index 4be7ffa7d1578ed87753c77fdb17772ceb46b252..dd79eec501871e5141c88618d20e1817ca5d4abc 100644
--- a/dist/cjs/Http/Multipart.js
+++ b/dist/cjs/Http/Multipart.js
@@ -3,7 +3,7 @@
 Object.defineProperty(exports, "__esModule", {
   value: true
 });
-exports.withMaxParts = exports.withMaxFileSize = exports.withMaxFieldSize = exports.withFieldMimeTypes = exports.toPersisted = exports.schemaPersisted = exports.schemaJson = exports.maxParts = exports.maxFileSize = exports.maxFieldSize = exports.makeConfig = exports.makeChannel = exports.isPersistedFile = exports.isPart = exports.isFile = exports.isField = exports.filesSchema = exports.fieldMimeTypes = exports.TypeId = exports.MultipartError = exports.ErrorTypeId = void 0;
+exports.withMaxParts = exports.withMaxFileSize = exports.withMaxFieldSize = exports.withFieldMimeTypes = exports.toPersisted = exports.schemaPersisted = exports.schemaJson = exports.maxParts = exports.maxFileSize = exports.maxFieldSize = exports.makeConfig = exports.makeChannel = exports.isPersistedFile = exports.isPart = exports.isFile = exports.isField = exports.fieldMimeTypes = exports.TypeId = exports.SingleFileSchema = exports.MultipartError = exports.FilesSchema = exports.FileSchema = exports.ErrorTypeId = void 0;
 var internal = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("../internal/http/multipart.js"));
 function _getRequireWildcardCache(e) {
   if ("function" != typeof WeakMap) return null;
@@ -109,7 +109,17 @@ const withFieldMimeTypes = exports.withFieldMimeTypes = internal.withFieldMimeTy
  * @since 1.0.0
  * @category schema
  */
-const filesSchema = exports.filesSchema = internal.filesSchema;
+const FileSchema = exports.FileSchema = internal.FileSchema;
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+const FilesSchema = exports.FilesSchema = internal.FilesSchema;
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+const SingleFileSchema = exports.SingleFileSchema = internal.SingleFileSchema;
 /**
  * @since 1.0.0
  * @category schema
diff --git a/dist/cjs/Http/Multipart.js.map b/dist/cjs/Http/Multipart.js.map
index e9ae0a6ac6a54cc28c1d023075c87a9231bfe49f..7498dc1f3b1e4c6ea25b8818b2daf629013b9af7 100644
--- a/dist/cjs/Http/Multipart.js.map
+++ b/dist/cjs/Http/Multipart.js.map
@@ -1 +1 @@
-{"version":3,"file":"Multipart.js","names":["internal","_interopRequireWildcard","require","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","isPart","isField","isFile","isPersistedFile","ErrorTypeId","MultipartError","maxParts","withMaxParts","maxFieldSize","withMaxFieldSize","maxFileSize","withMaxFileSize","fieldMimeTypes","withFieldMimeTypes","filesSchema","schemaJson","schemaPersisted","makeChannel","makeConfig","toPersisted"],"sources":["../../../src/Http/Multipart.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"Multipart.js","names":["internal","_interopRequireWildcard","require","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","isPart","isField","isFile","isPersistedFile","ErrorTypeId","MultipartError","maxParts","withMaxParts","maxFieldSize","withMaxFieldSize","maxFileSize","withMaxFileSize","fieldMimeTypes","withFieldMimeTypes","FileSchema","FilesSchema","SingleFileSchema","schemaJson","schemaPersisted","makeChannel","makeConfig","toPersisted"],"sources":["../../../src/Http/Multipart.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/internal/http/client.js b/dist/cjs/internal/http/client.js
index 96e962a9c37aaceca6f3a053ea192c4455f35e1e..fbfd2da061a0b6fff8d1c43119d27e71eac5d3c8 100644
--- a/dist/cjs/internal/http/client.js
+++ b/dist/cjs/internal/http/client.js
@@ -98,11 +98,16 @@ const makeDefault = f => make(effect => Effect.flatMap(effect, request => Effect
   if (tracerDisabled) {
     return Effect.zipRight(addAbort, f(request, url, controller.signal, fiber));
   }
-  return Effect.zipRight(addAbort, Effect.useSpan(`http.client ${request.method}`, span => {
+  return Effect.zipRight(addAbort, Effect.useSpan(`http.client ${request.method}`, {
+    kind: "client"
+  }, span => {
+    span.attribute("http.method", request.method);
+    span.attribute("http.request.method", request.method);
     span.attribute("server.address", url.origin);
     if (url.port !== "") {
       span.attribute("server.port", +url.port);
     }
+    span.attribute("http.url", url.toString());
     span.attribute("url.full", url.toString());
     span.attribute("url.path", url.pathname);
     span.attribute("url.scheme", url.protocol.slice(0, -1));
@@ -117,6 +122,7 @@ const makeDefault = f => make(effect => Effect.flatMap(effect, request => Effect
     }
     return Effect.tap(Effect.withParentSpan(f(internalRequest.setHeaders(request, TraceContext.toHeaders(span)), url, controller.signal, fiber), span), response => {
       span.attribute("http.response.status_code", response.status);
+      span.attribute("http.status_code", response.status);
       const redactedHeaders = Headers.redact(response.headers, redactedHeaderNames);
       for (const name in redactedHeaders) {
         span.attribute(`http.response.header.${name}`, String(redactedHeaders[name]));
diff --git a/dist/cjs/internal/http/client.js.map b/dist/cjs/internal/http/client.js.map
index 3b38cb8cdde55177456d3eb83804c75904e2e0b5..cc06c949622b970212894c88f07d7df4a47cbf28 100644
--- a/dist/cjs/internal/http/client.js.map
+++ b/dist/cjs/internal/http/client.js.map
@@ -1 +1 @@
-{"version":3,"file":"client.js","names":["Schema","_interopRequireWildcard","require","Context","Effect","FiberRef","_Function","_GlobalValue","Layer","_Pipeable","Predicate","Ref","Scope","Stream","Error","Cookies","Headers","Method","TraceContext","UrlParams","internalBody","internalRequest","internalResponse","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","Symbol","for","tag","GenericTag","currentTracerDisabledWhen","globalValue","unsafeMake","constFalse","withTracerDisabledWhen","dual","self","pred","locally","currentFetchOptions","withFetchOptions","options","clientProto","pipe","pipeArguments","arguments","isClient","hasProperty","make","execute","preprocess","client","request","setPrototypeOf","makeDefault","f","effect","flatMap","withFiberRuntime","fiber","scope","unsafeGet","getFiberRef","currentContext","controller","AbortController","addAbort","addFinalizer","sync","abort","urlResult","makeUrl","url","urlParams","_tag","fail","RequestError","reason","error","left","right","tracerDisabled","zipRight","signal","useSpan","method","span","attribute","origin","port","toString","pathname","protocol","slice","query","search","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","headers","name","String","tap","withParentSpan","setHeaders","toHeaders","response","status","succeed","Fetch","fetch","context","unsafeMap","key","globalThis","send","body","map","tryPromise","try","duplex","undefined","catch","fromWeb","hasBody","convertBody","formData","toReadableStream","stream","transform","filterStatus","filterOrFail","ResponseError","filterStatusOk","fetchOk","layer","transformResponse","catchTag","catchTags","cases","catchAll","filterOrElse","orElse","orFailWith","mapEffect","scoped","mapEffectScoped","mapRequest","mapRequestEffect","mapInputRequest","mapInputRequestEffect","retry","policy","schemaFunction","args","schema","encode","tryMap","TextEncoder","JSON","stringify","setBody","uint8Array","tapRequest","withCookiesRef","ref","update","cookies","merge","isEmpty","setHeader","toCookieHeader"],"sources":["../../../../src/internal/http/client.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"client.js","names":["Schema","_interopRequireWildcard","require","Context","Effect","FiberRef","_Function","_GlobalValue","Layer","_Pipeable","Predicate","Ref","Scope","Stream","Error","Cookies","Headers","Method","TraceContext","UrlParams","internalBody","internalRequest","internalResponse","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","Symbol","for","tag","GenericTag","currentTracerDisabledWhen","globalValue","unsafeMake","constFalse","withTracerDisabledWhen","dual","self","pred","locally","currentFetchOptions","withFetchOptions","options","clientProto","pipe","pipeArguments","arguments","isClient","hasProperty","make","execute","preprocess","client","request","setPrototypeOf","makeDefault","f","effect","flatMap","withFiberRuntime","fiber","scope","unsafeGet","getFiberRef","currentContext","controller","AbortController","addAbort","addFinalizer","sync","abort","urlResult","makeUrl","url","urlParams","_tag","fail","RequestError","reason","error","left","right","tracerDisabled","zipRight","signal","useSpan","method","kind","span","attribute","origin","port","toString","pathname","protocol","slice","query","search","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","headers","name","String","tap","withParentSpan","setHeaders","toHeaders","response","status","succeed","Fetch","fetch","context","unsafeMap","key","globalThis","send","body","map","tryPromise","try","duplex","undefined","catch","fromWeb","hasBody","convertBody","formData","toReadableStream","stream","transform","filterStatus","filterOrFail","ResponseError","filterStatusOk","fetchOk","layer","transformResponse","catchTag","catchTags","cases","catchAll","filterOrElse","orElse","orFailWith","mapEffect","scoped","mapEffectScoped","mapRequest","mapRequestEffect","mapInputRequest","mapInputRequestEffect","retry","policy","schemaFunction","args","schema","encode","tryMap","TextEncoder","JSON","stringify","setBody","uint8Array","tapRequest","withCookiesRef","ref","update","cookies","merge","isEmpty","setHeader","toCookieHeader"],"sources":["../../../../src/internal/http/client.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/internal/http/middleware.js b/dist/cjs/internal/http/middleware.js
index 33aed5576fc861792bebb8d5867018d0ecc134a6..972e03d7abf1130685c9b47dcd9edc8d8d11ee29 100644
--- a/dist/cjs/internal/http/middleware.js
+++ b/dist/cjs/internal/http/middleware.js
@@ -101,10 +101,13 @@ const tracer = exports.tracer = /*#__PURE__*/make(httpApp => Effect.withFiberRun
   const redactedHeaderNames = fiber.getFiberRef(Headers.currentRedactedNames);
   const redactedHeaders = Headers.redact(request.headers, redactedHeaderNames);
   return Effect.useSpan(`http.server ${request.method}`, {
-    parent: Option.getOrUndefined(TraceContext.fromHeaders(request.headers))
+    parent: Option.getOrUndefined(TraceContext.fromHeaders(request.headers)),
+    kind: "server"
   }, span => {
+    span.attribute("http.method", request.method);
     span.attribute("http.request.method", request.method);
     if (url !== undefined) {
+      span.attribute("http.url", url.toString());
       span.attribute("url.full", url.toString());
       span.attribute("url.path", url.pathname);
       const query = url.search.slice(1);
@@ -125,9 +128,11 @@ const tracer = exports.tracer = /*#__PURE__*/make(httpApp => Effect.withFiberRun
     return Effect.flatMap(Effect.exit(Effect.withParentSpan(httpApp, span)), exit => {
       if (exit._tag === "Failure") {
         span.attribute("http.response.status_code", ServerError.causeStatusCode(exit.cause));
+        span.attribute("http.status_code", ServerError.causeStatusCode(exit.cause));
       } else {
         const response = exit.value;
         span.attribute("http.response.status_code", response.status);
+        span.attribute("http.status_code", response.status);
         const redactedHeaders = Headers.redact(response.headers, redactedHeaderNames);
         for (const name in redactedHeaders) {
           span.attribute(`http.response.header.${name}`, String(redactedHeaders[name]));
diff --git a/dist/cjs/internal/http/middleware.js.map b/dist/cjs/internal/http/middleware.js.map
index ce7d68ba911373a49f0c7a76b2cea2421970ee4a..cf3613e895a7ed1441b5c40260e243bbd699f999 100644
--- a/dist/cjs/internal/http/middleware.js.map
+++ b/dist/cjs/internal/http/middleware.js.map
@@ -1 +1 @@
-{"version":3,"file":"middleware.js","names":["Context","_interopRequireWildcard","require","Effect","FiberRef","_Function","_GlobalValue","Layer","Option","Headers","ServerError","ServerRequest","TraceContext","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","make","middleware","exports","loggerDisabled","globalValue","Symbol","for","unsafeMake","withLoggerDisabled","self","zipRight","currentTracerDisabledWhen","constFalse","withTracerDisabledWhen","dual","pred","locally","withTracerDisabledWhenEffect","withTracerDisabledForUrls","urls","req","includes","url","logger","httpApp","counter","withFiberRuntime","fiber","context","getFiberRef","currentContext","request","unsafeGet","withLogSpan","flatMap","exit","_tag","annotateLogs","log","cause","method","causeStatusCode","value","status","tracer","disabled","host","headers","protocol","undefined","URL","username","password","_","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","useSpan","parent","getOrUndefined","fromHeaders","span","attribute","toString","pathname","query","search","slice","name","String","remoteAddress","withParentSpan","response","xForwardedHeaders","updateService","modify","split","trim"],"sources":["../../../../src/internal/http/middleware.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"middleware.js","names":["Context","_interopRequireWildcard","require","Effect","FiberRef","_Function","_GlobalValue","Layer","Option","Headers","ServerError","ServerRequest","TraceContext","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","make","middleware","exports","loggerDisabled","globalValue","Symbol","for","unsafeMake","withLoggerDisabled","self","zipRight","currentTracerDisabledWhen","constFalse","withTracerDisabledWhen","dual","pred","locally","withTracerDisabledWhenEffect","withTracerDisabledForUrls","urls","req","includes","url","logger","httpApp","counter","withFiberRuntime","fiber","context","getFiberRef","currentContext","request","unsafeGet","withLogSpan","flatMap","exit","_tag","annotateLogs","log","cause","method","causeStatusCode","value","status","tracer","disabled","host","headers","protocol","undefined","URL","username","password","_","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","useSpan","parent","getOrUndefined","fromHeaders","kind","span","attribute","toString","pathname","query","search","slice","name","String","remoteAddress","withParentSpan","response","xForwardedHeaders","updateService","modify","split","trim"],"sources":["../../../../src/internal/http/middleware.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/internal/http/multipart.js b/dist/cjs/internal/http/multipart.js
index d5f7e6f27ae6c9a0af1ea4a454bdb76150881eac..85ecd16c091e4ef6f9051103aa833e4241256ccf 100644
--- a/dist/cjs/internal/http/multipart.js
+++ b/dist/cjs/internal/http/multipart.js
@@ -3,7 +3,7 @@
 Object.defineProperty(exports, "__esModule", {
   value: true
 });
-exports.withMaxParts = exports.withMaxFileSize = exports.withMaxFieldSize = exports.withFieldMimeTypes = exports.toPersisted = exports.schemaPersisted = exports.schemaJson = exports.maxParts = exports.maxFileSize = exports.maxFieldSize = exports.makeConfig = exports.makeChannel = exports.isPersistedFile = exports.isPart = exports.isFile = exports.isField = exports.filesSchema = exports.fieldMimeTypes = exports.TypeId = exports.MultipartError = exports.ErrorTypeId = void 0;
+exports.withMaxParts = exports.withMaxFileSize = exports.withMaxFieldSize = exports.withFieldMimeTypes = exports.toPersisted = exports.schemaPersisted = exports.schemaJson = exports.maxParts = exports.maxFileSize = exports.maxFieldSize = exports.makeConfig = exports.makeChannel = exports.isPersistedFile = exports.isPart = exports.isFile = exports.isField = exports.fieldMimeTypes = exports.TypeId = exports.SingleFileSchema = exports.MultipartError = exports.FilesSchema = exports.FileSchema = exports.ErrorTypeId = void 0;
 var Schema = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("@effect/schema/Schema"));
 var Cause = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("effect/Cause"));
 var Channel = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("effect/Channel"));
@@ -86,11 +86,17 @@ const withMaxFileSize = exports.withMaxFileSize = /*#__PURE__*/(0, _Function.dua
 const fieldMimeTypes = exports.fieldMimeTypes = /*#__PURE__*/(0, _GlobalValue.globalValue)("@effect/platform/Http/Multipart/fieldMimeTypes", () => FiberRef.unsafeMake(Chunk.make("application/json")));
 /** @internal */
 const withFieldMimeTypes = exports.withFieldMimeTypes = /*#__PURE__*/(0, _Function.dual)(2, (effect, mimeTypes) => Effect.locally(effect, fieldMimeTypes, Chunk.fromIterable(mimeTypes)));
-const fileSchema = /*#__PURE__*/Schema.declare(isPersistedFile, {
+/** @internal */
+const FileSchema = exports.FileSchema = /*#__PURE__*/Schema.declare(isPersistedFile, {
   identifier: "PersistedFile"
 });
 /** @internal */
-const filesSchema = exports.filesSchema = /*#__PURE__*/Schema.Array(fileSchema);
+const FilesSchema = exports.FilesSchema = /*#__PURE__*/Schema.Array(FileSchema);
+/** @internal */
+const SingleFileSchema = exports.SingleFileSchema = /*#__PURE__*/Schema.transform( /*#__PURE__*/FilesSchema.pipe( /*#__PURE__*/Schema.itemsCount(1)), FileSchema, {
+  decode: ([file]) => file,
+  encode: file => [file]
+});
 /** @internal */
 const schemaPersisted = (schema, options) => {
   const parse = Schema.decodeUnknown(schema, options);
diff --git a/dist/cjs/internal/http/multipart.js.map b/dist/cjs/internal/http/multipart.js.map
index 658df3e77174484b62c030a6d0f8bad7876e51c2..42a2a9caa81b445d21227316b1c36fb27139ad80 100644
--- a/dist/cjs/internal/http/multipart.js.map
+++ b/dist/cjs/internal/http/multipart.js.map
@@ -1 +1 @@
-{"version":3,"file":"multipart.js","names":["Schema","_interopRequireWildcard","require","Cause","Channel","Chunk","Effect","FiberRef","_Function","_GlobalValue","Inspectable","Option","Predicate","Queue","Stream","MP","_Error","FileSystem","IncomingMessage","Path","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","Symbol","for","isPart","hasProperty","isField","_tag","isFile","isPersistedFile","isTagged","ErrorTypeId","MultipartError","RefailError","message","reason","maxParts","globalValue","unsafeMake","none","withMaxParts","dual","effect","count","locally","maxFieldSize","Size","withMaxFieldSize","size","maxFileSize","withMaxFileSize","map","fieldMimeTypes","make","withFieldMimeTypes","mimeTypes","fromIterable","fileSchema","declare","identifier","filesSchema","Array","schemaPersisted","schema","options","parse","decodeUnknown","persisted","schemaJson","fromJson","parseJson","field","Struct","_","makeConfig","headers","all","getOrUndefined","Number","maxPartSize","flow","maxTotalSize","maxBodySize","length","undefined","info","some","contentType","includes","defaultIsFile","makeChannel","bufferSize","acquireUseRelease","bounded","config","queue","makeFromQueue","shutdown","suspend","error","partsBuffer","partsFinished","input","awaitRead","void","emit","element","offer","cause","done","_value","parser","onField","value","push","FieldImpl","name","decodeField","onFile","chunks","finished","take","zipRight","pump","chunk","unsafeFromArray","write","FileImpl","onError","error_","fail","convertError","onDone","flatMap","sync","end","forEach","buf","takeParts","parts","partsChannel","failCause","embedInput","limit","PartBase","Class","constructor","key","toJSON","_id","content","channel","filename","fromChannel","defaultWriteFile","path","file","fs","mapError","run","sink","toPersisted","stream","writeFile","pipe","Do","bind","makeTempDirectoryScoped","dir","path_","runFoldEffect","create","part","succeed","join","basename","slice","isArray","PersistedFileImpl","as","catchTags","SystemError","BadArgument"],"sources":["../../../../src/internal/http/multipart.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"multipart.js","names":["Schema","_interopRequireWildcard","require","Cause","Channel","Chunk","Effect","FiberRef","_Function","_GlobalValue","Inspectable","Option","Predicate","Queue","Stream","MP","_Error","FileSystem","IncomingMessage","Path","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TypeId","exports","Symbol","for","isPart","hasProperty","isField","_tag","isFile","isPersistedFile","isTagged","ErrorTypeId","MultipartError","RefailError","message","reason","maxParts","globalValue","unsafeMake","none","withMaxParts","dual","effect","count","locally","maxFieldSize","Size","withMaxFieldSize","size","maxFileSize","withMaxFileSize","map","fieldMimeTypes","make","withFieldMimeTypes","mimeTypes","fromIterable","FileSchema","declare","identifier","FilesSchema","Array","SingleFileSchema","transform","pipe","itemsCount","decode","file","encode","schemaPersisted","schema","options","parse","decodeUnknown","persisted","schemaJson","fromJson","parseJson","field","Struct","_","makeConfig","headers","all","getOrUndefined","Number","maxPartSize","flow","maxTotalSize","maxBodySize","length","undefined","info","some","contentType","includes","defaultIsFile","makeChannel","bufferSize","acquireUseRelease","bounded","config","queue","makeFromQueue","shutdown","suspend","error","partsBuffer","partsFinished","input","awaitRead","void","emit","element","offer","cause","done","_value","parser","onField","value","push","FieldImpl","name","decodeField","onFile","chunks","finished","take","zipRight","pump","chunk","unsafeFromArray","write","FileImpl","onError","error_","fail","convertError","onDone","flatMap","sync","end","forEach","buf","takeParts","parts","partsChannel","failCause","embedInput","limit","PartBase","Class","constructor","key","toJSON","_id","content","channel","filename","fromChannel","defaultWriteFile","path","fs","mapError","run","sink","toPersisted","stream","writeFile","Do","bind","makeTempDirectoryScoped","dir","path_","runFoldEffect","create","part","succeed","join","basename","slice","isArray","PersistedFileImpl","as","catchTags","SystemError","BadArgument"],"sources":["../../../../src/internal/http/multipart.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/dts/Http/Multipart.d.ts b/dist/dts/Http/Multipart.d.ts
index 886c02996c7d24a7a2a6fc4319a13397d8600cd4..a91a1491dbe108ad29d2cdfe79b335662005ed76 100644
--- a/dist/dts/Http/Multipart.d.ts
+++ b/dist/dts/Http/Multipart.d.ts
@@ -187,7 +187,17 @@ export declare const withFieldMimeTypes: {
  * @since 1.0.0
  * @category schema
  */
-export declare const filesSchema: Schema.Schema<ReadonlyArray<PersistedFile>>;
+export declare const FileSchema: Schema.Schema<PersistedFile>;
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+export declare const FilesSchema: Schema.Schema<ReadonlyArray<PersistedFile>>;
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+export declare const SingleFileSchema: Schema.transform<Schema.Schema<ReadonlyArray<PersistedFile>>, Schema.Schema<PersistedFile>>;
 /**
  * @since 1.0.0
  * @category schema
diff --git a/dist/dts/Http/Multipart.d.ts.map b/dist/dts/Http/Multipart.d.ts.map
index 4120621939f026c12e0bbde4dffc1b2f1751e212..b4430e1f59e101894e666901c6f9b6ac70b864a7 100644
--- a/dist/dts/Http/Multipart.d.ts.map
+++ b/dist/dts/Http/Multipart.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"Multipart.d.ts","sourceRoot":"","sources":["../../../src/Http/Multipart.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"Multipart.d.ts","sourceRoot":"","sources":["../../../src/Http/Multipart.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/esm/Http/Multipart.js b/dist/esm/Http/Multipart.js
index e73edf5141f9dd23421f510fc71558a330a54c4c..7f13363c811152a65c8b0f5f665d90a07aa0c469 100644
--- a/dist/esm/Http/Multipart.js
+++ b/dist/esm/Http/Multipart.js
@@ -78,7 +78,17 @@ export const withFieldMimeTypes = internal.withFieldMimeTypes;
  * @since 1.0.0
  * @category schema
  */
-export const filesSchema = internal.filesSchema;
+export const FileSchema = internal.FileSchema;
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+export const FilesSchema = internal.FilesSchema;
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+export const SingleFileSchema = internal.SingleFileSchema;
 /**
  * @since 1.0.0
  * @category schema
diff --git a/dist/esm/Http/Multipart.js.map b/dist/esm/Http/Multipart.js.map
index 48dd977aecec47e0a3b094938e7dc57aef86f5b0..bdbc144580f6a769c5255e84e2080dd4d57e4dbe 100644
--- a/dist/esm/Http/Multipart.js.map
+++ b/dist/esm/Http/Multipart.js.map
@@ -1 +1 @@
-{"version":3,"file":"Multipart.js","names":["internal","TypeId","isPart","isField","isFile","isPersistedFile","ErrorTypeId","MultipartError","maxParts","withMaxParts","maxFieldSize","withMaxFieldSize","maxFileSize","withMaxFileSize","fieldMimeTypes","withFieldMimeTypes","filesSchema","schemaJson","schemaPersisted","makeChannel","makeConfig","toPersisted"],"sources":["../../../src/Http/Multipart.ts"],"sourcesContent":[null],"mappings":"AAiBA,OAAO,KAAKA,QAAQ,MAAM,+BAA+B;AAGzD;;;;AAIA,OAAO,MAAMC,MAAM,GAAkBD,QAAQ,CAACC,MAAM;AAcpD;;;;AAIA,OAAO,MAAMC,MAAM,GAA8BF,QAAQ,CAACE,MAAM;AA2BhE;;;;AAIA,OAAO,MAAMC,OAAO,GAA+BH,QAAQ,CAACG,OAAO;AAcnE;;;;AAIA,OAAO,MAAMC,MAAM,GAA8BJ,QAAQ,CAACI,MAAM;AAchE;;;;AAIA,OAAO,MAAMC,eAAe,GAAuCL,QAAQ,CAACK,eAAe;AAU3F;;;;AAIA,OAAO,MAAMC,WAAW,GAAkBN,QAAQ,CAACM,WAAW;AAmB9D;;;;AAIA,OAAO,MAAMC,cAAc,GAKLP,QAAQ,CAACO,cAAc;AAE7C;;;;AAIA,OAAO,MAAMC,QAAQ,GAA6CR,QAAQ,CAACQ,QAAQ;AAEnF;;;;AAIA,OAAO,MAAMC,YAAY,GAGrBT,QAAQ,CAACS,YAAY;AAEzB;;;;AAIA,OAAO,MAAMC,YAAY,GAAuCV,QAAQ,CAACU,YAAY;AAErF;;;;AAIA,OAAO,MAAMC,gBAAgB,GAGzBX,QAAQ,CAACW,gBAAgB;AAE7B;;;;AAIA,OAAO,MAAMC,WAAW,GAAsDZ,QAAQ,CAACY,WAAW;AAElG;;;;AAIA,OAAO,MAAMC,eAAe,GAGxBb,QAAQ,CAACa,eAAe;AAE5B;;;;AAIA,OAAO,MAAMC,cAAc,GAA2Cd,QAAQ,CAACc,cAAc;AAE7F;;;;AAIA,OAAO,MAAMC,kBAAkB,GAG3Bf,QAAQ,CAACe,kBAAkB;AAE/B;;;;AAIA,OAAO,MAAMC,WAAW,GAAgDhB,QAAQ,CAACgB,WAAW;AAE5F;;;;AAIA,OAAO,MAAMC,UAAU,GAMnBjB,QAAQ,CAACiB,UAAU;AAEvB;;;;AAIA,OAAO,MAAMC,eAAe,GAGiDlB,QAAQ,CAACkB,eAAe;AAErG;;;;AAIA,OAAO,MAAMC,WAAW,GAItBnB,QAAQ,CAACmB,WAAW;AAEtB;;;;AAIA,OAAO,MAAMC,UAAU,GAA8EpB,QAAQ,CAACoB,UAAU;AAExH;;;;AAIA,OAAO,MAAMC,WAAW,GAGyErB,QAAQ,CAACqB,WAAW","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"Multipart.js","names":["internal","TypeId","isPart","isField","isFile","isPersistedFile","ErrorTypeId","MultipartError","maxParts","withMaxParts","maxFieldSize","withMaxFieldSize","maxFileSize","withMaxFileSize","fieldMimeTypes","withFieldMimeTypes","FileSchema","FilesSchema","SingleFileSchema","schemaJson","schemaPersisted","makeChannel","makeConfig","toPersisted"],"sources":["../../../src/Http/Multipart.ts"],"sourcesContent":[null],"mappings":"AAiBA,OAAO,KAAKA,QAAQ,MAAM,+BAA+B;AAGzD;;;;AAIA,OAAO,MAAMC,MAAM,GAAkBD,QAAQ,CAACC,MAAM;AAcpD;;;;AAIA,OAAO,MAAMC,MAAM,GAA8BF,QAAQ,CAACE,MAAM;AA2BhE;;;;AAIA,OAAO,MAAMC,OAAO,GAA+BH,QAAQ,CAACG,OAAO;AAcnE;;;;AAIA,OAAO,MAAMC,MAAM,GAA8BJ,QAAQ,CAACI,MAAM;AAchE;;;;AAIA,OAAO,MAAMC,eAAe,GAAuCL,QAAQ,CAACK,eAAe;AAU3F;;;;AAIA,OAAO,MAAMC,WAAW,GAAkBN,QAAQ,CAACM,WAAW;AAmB9D;;;;AAIA,OAAO,MAAMC,cAAc,GAKLP,QAAQ,CAACO,cAAc;AAE7C;;;;AAIA,OAAO,MAAMC,QAAQ,GAA6CR,QAAQ,CAACQ,QAAQ;AAEnF;;;;AAIA,OAAO,MAAMC,YAAY,GAGrBT,QAAQ,CAACS,YAAY;AAEzB;;;;AAIA,OAAO,MAAMC,YAAY,GAAuCV,QAAQ,CAACU,YAAY;AAErF;;;;AAIA,OAAO,MAAMC,gBAAgB,GAGzBX,QAAQ,CAACW,gBAAgB;AAE7B;;;;AAIA,OAAO,MAAMC,WAAW,GAAsDZ,QAAQ,CAACY,WAAW;AAElG;;;;AAIA,OAAO,MAAMC,eAAe,GAGxBb,QAAQ,CAACa,eAAe;AAE5B;;;;AAIA,OAAO,MAAMC,cAAc,GAA2Cd,QAAQ,CAACc,cAAc;AAE7F;;;;AAIA,OAAO,MAAMC,kBAAkB,GAG3Bf,QAAQ,CAACe,kBAAkB;AAE/B;;;;AAIA,OAAO,MAAMC,UAAU,GAAiChB,QAAQ,CAACgB,UAAU;AAE3E;;;;AAIA,OAAO,MAAMC,WAAW,GAAgDjB,QAAQ,CAACiB,WAAW;AAE5F;;;;AAIA,OAAO,MAAMC,gBAAgB,GAGzBlB,QAAQ,CAACkB,gBAAgB;AAE7B;;;;AAIA,OAAO,MAAMC,UAAU,GAMnBnB,QAAQ,CAACmB,UAAU;AAEvB;;;;AAIA,OAAO,MAAMC,eAAe,GAGiDpB,QAAQ,CAACoB,eAAe;AAErG;;;;AAIA,OAAO,MAAMC,WAAW,GAItBrB,QAAQ,CAACqB,WAAW;AAEtB;;;;AAIA,OAAO,MAAMC,UAAU,GAA8EtB,QAAQ,CAACsB,UAAU;AAExH;;;;AAIA,OAAO,MAAMC,WAAW,GAGyEvB,QAAQ,CAACuB,WAAW","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/internal/http/client.js b/dist/esm/internal/http/client.js
index 63f147661dca1a84026f8c2afcc4a57cf79519d1..1c53efc1a45b3a0025eb12aa7a92518c52179d3a 100644
--- a/dist/esm/internal/http/client.js
+++ b/dist/esm/internal/http/client.js
@@ -66,11 +66,16 @@ export const makeDefault = f => make(effect => Effect.flatMap(effect, request =>
   if (tracerDisabled) {
     return Effect.zipRight(addAbort, f(request, url, controller.signal, fiber));
   }
-  return Effect.zipRight(addAbort, Effect.useSpan(`http.client ${request.method}`, span => {
+  return Effect.zipRight(addAbort, Effect.useSpan(`http.client ${request.method}`, {
+    kind: "client"
+  }, span => {
+    span.attribute("http.method", request.method);
+    span.attribute("http.request.method", request.method);
     span.attribute("server.address", url.origin);
     if (url.port !== "") {
       span.attribute("server.port", +url.port);
     }
+    span.attribute("http.url", url.toString());
     span.attribute("url.full", url.toString());
     span.attribute("url.path", url.pathname);
     span.attribute("url.scheme", url.protocol.slice(0, -1));
@@ -85,6 +90,7 @@ export const makeDefault = f => make(effect => Effect.flatMap(effect, request =>
     }
     return Effect.tap(Effect.withParentSpan(f(internalRequest.setHeaders(request, TraceContext.toHeaders(span)), url, controller.signal, fiber), span), response => {
       span.attribute("http.response.status_code", response.status);
+      span.attribute("http.status_code", response.status);
       const redactedHeaders = Headers.redact(response.headers, redactedHeaderNames);
       for (const name in redactedHeaders) {
         span.attribute(`http.response.header.${name}`, String(redactedHeaders[name]));
diff --git a/dist/esm/internal/http/client.js.map b/dist/esm/internal/http/client.js.map
index 549034c5979b5176210762458d88ca7d75b90969..70f26cf4472d2d1a5a6d8ffe1abc6d72fad10394 100644
--- a/dist/esm/internal/http/client.js.map
+++ b/dist/esm/internal/http/client.js.map
@@ -1 +1 @@
-{"version":3,"file":"client.js","names":["Schema","Context","Effect","FiberRef","constFalse","dual","globalValue","Layer","pipeArguments","Predicate","Ref","Scope","Stream","Error","Cookies","Headers","Method","TraceContext","UrlParams","internalBody","internalRequest","internalResponse","TypeId","Symbol","for","tag","GenericTag","currentTracerDisabledWhen","unsafeMake","withTracerDisabledWhen","self","pred","locally","currentFetchOptions","withFetchOptions","options","clientProto","pipe","arguments","isClient","u","hasProperty","make","execute","preprocess","client","request","Object","setPrototypeOf","makeDefault","f","effect","flatMap","withFiberRuntime","fiber","scope","unsafeGet","getFiberRef","currentContext","controller","AbortController","addAbort","addFinalizer","sync","abort","urlResult","makeUrl","url","urlParams","_tag","fail","RequestError","reason","error","left","right","tracerDisabled","zipRight","signal","useSpan","method","span","attribute","origin","port","toString","pathname","protocol","slice","query","search","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","headers","name","String","tap","withParentSpan","setHeaders","toHeaders","response","status","succeed","Fetch","fetch","context","unsafeMap","get","key","globalThis","send","body","map","tryPromise","try","duplex","undefined","catch","fromWeb","hasBody","convertBody","formData","toReadableStream","stream","transform","filterStatus","filterOrFail","ResponseError","filterStatusOk","fetchOk","layer","transformResponse","catchTag","catchTags","cases","catchAll","filterOrElse","orElse","orFailWith","mapEffect","scoped","mapEffectScoped","mapRequest","mapRequestEffect","mapInputRequest","mapInputRequestEffect","retry","policy","schemaFunction","args","schema","encode","a","tryMap","TextEncoder","JSON","stringify","setBody","uint8Array","tapRequest","withCookiesRef","ref","update","cookies","merge","isEmpty","setHeader","toCookieHeader"],"sources":["../../../../src/internal/http/client.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"client.js","names":["Schema","Context","Effect","FiberRef","constFalse","dual","globalValue","Layer","pipeArguments","Predicate","Ref","Scope","Stream","Error","Cookies","Headers","Method","TraceContext","UrlParams","internalBody","internalRequest","internalResponse","TypeId","Symbol","for","tag","GenericTag","currentTracerDisabledWhen","unsafeMake","withTracerDisabledWhen","self","pred","locally","currentFetchOptions","withFetchOptions","options","clientProto","pipe","arguments","isClient","u","hasProperty","make","execute","preprocess","client","request","Object","setPrototypeOf","makeDefault","f","effect","flatMap","withFiberRuntime","fiber","scope","unsafeGet","getFiberRef","currentContext","controller","AbortController","addAbort","addFinalizer","sync","abort","urlResult","makeUrl","url","urlParams","_tag","fail","RequestError","reason","error","left","right","tracerDisabled","zipRight","signal","useSpan","method","kind","span","attribute","origin","port","toString","pathname","protocol","slice","query","search","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","headers","name","String","tap","withParentSpan","setHeaders","toHeaders","response","status","succeed","Fetch","fetch","context","unsafeMap","get","key","globalThis","send","body","map","tryPromise","try","duplex","undefined","catch","fromWeb","hasBody","convertBody","formData","toReadableStream","stream","transform","filterStatus","filterOrFail","ResponseError","filterStatusOk","fetchOk","layer","transformResponse","catchTag","catchTags","cases","catchAll","filterOrElse","orElse","orFailWith","mapEffect","scoped","mapEffectScoped","mapRequest","mapRequestEffect","mapInputRequest","mapInputRequestEffect","retry","policy","schemaFunction","args","schema","encode","a","tryMap","TextEncoder","JSON","stringify","setBody","uint8Array","tapRequest","withCookiesRef","ref","update","cookies","merge","isEmpty","setHeader","toCookieHeader"],"sources":["../../../../src/internal/http/client.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/internal/http/middleware.js b/dist/esm/internal/http/middleware.js
index 4f4dc93afc65dd0c8e8d88f935a624767cc22c61..f3a084120af1ddbf6b95c0caea4be2da7ab230a9 100644
--- a/dist/esm/internal/http/middleware.js
+++ b/dist/esm/internal/http/middleware.js
@@ -68,10 +68,13 @@ export const tracer = /*#__PURE__*/make(httpApp => Effect.withFiberRuntime(fiber
   const redactedHeaderNames = fiber.getFiberRef(Headers.currentRedactedNames);
   const redactedHeaders = Headers.redact(request.headers, redactedHeaderNames);
   return Effect.useSpan(`http.server ${request.method}`, {
-    parent: Option.getOrUndefined(TraceContext.fromHeaders(request.headers))
+    parent: Option.getOrUndefined(TraceContext.fromHeaders(request.headers)),
+    kind: "server"
   }, span => {
+    span.attribute("http.method", request.method);
     span.attribute("http.request.method", request.method);
     if (url !== undefined) {
+      span.attribute("http.url", url.toString());
       span.attribute("url.full", url.toString());
       span.attribute("url.path", url.pathname);
       const query = url.search.slice(1);
@@ -92,9 +95,11 @@ export const tracer = /*#__PURE__*/make(httpApp => Effect.withFiberRuntime(fiber
     return Effect.flatMap(Effect.exit(Effect.withParentSpan(httpApp, span)), exit => {
       if (exit._tag === "Failure") {
         span.attribute("http.response.status_code", ServerError.causeStatusCode(exit.cause));
+        span.attribute("http.status_code", ServerError.causeStatusCode(exit.cause));
       } else {
         const response = exit.value;
         span.attribute("http.response.status_code", response.status);
+        span.attribute("http.status_code", response.status);
         const redactedHeaders = Headers.redact(response.headers, redactedHeaderNames);
         for (const name in redactedHeaders) {
           span.attribute(`http.response.header.${name}`, String(redactedHeaders[name]));
diff --git a/dist/esm/internal/http/middleware.js.map b/dist/esm/internal/http/middleware.js.map
index bf42464540a46f8cdaf46ff1d4b2f1f5c92774bc..ee79641187f667ee7d4f5b76fedd7198902b76fd 100644
--- a/dist/esm/internal/http/middleware.js.map
+++ b/dist/esm/internal/http/middleware.js.map
@@ -1 +1 @@
-{"version":3,"file":"middleware.js","names":["Context","Effect","FiberRef","constFalse","dual","globalValue","Layer","Option","Headers","ServerError","ServerRequest","TraceContext","make","middleware","loggerDisabled","Symbol","for","unsafeMake","withLoggerDisabled","self","zipRight","set","currentTracerDisabledWhen","withTracerDisabledWhen","pred","locally","withTracerDisabledWhenEffect","withTracerDisabledForUrls","urls","req","includes","url","logger","httpApp","counter","withFiberRuntime","fiber","context","getFiberRef","currentContext","request","unsafeGet","withLogSpan","flatMap","exit","_tag","annotateLogs","log","cause","method","causeStatusCode","value","status","tracer","disabled","host","headers","protocol","undefined","URL","username","password","_","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","useSpan","parent","getOrUndefined","fromHeaders","span","attribute","toString","pathname","query","search","slice","name","String","remoteAddress","withParentSpan","response","xForwardedHeaders","updateService","modify","split","trim"],"sources":["../../../../src/internal/http/middleware.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"middleware.js","names":["Context","Effect","FiberRef","constFalse","dual","globalValue","Layer","Option","Headers","ServerError","ServerRequest","TraceContext","make","middleware","loggerDisabled","Symbol","for","unsafeMake","withLoggerDisabled","self","zipRight","set","currentTracerDisabledWhen","withTracerDisabledWhen","pred","locally","withTracerDisabledWhenEffect","withTracerDisabledForUrls","urls","req","includes","url","logger","httpApp","counter","withFiberRuntime","fiber","context","getFiberRef","currentContext","request","unsafeGet","withLogSpan","flatMap","exit","_tag","annotateLogs","log","cause","method","causeStatusCode","value","status","tracer","disabled","host","headers","protocol","undefined","URL","username","password","_","redactedHeaderNames","currentRedactedNames","redactedHeaders","redact","useSpan","parent","getOrUndefined","fromHeaders","kind","span","attribute","toString","pathname","query","search","slice","name","String","remoteAddress","withParentSpan","response","xForwardedHeaders","updateService","modify","split","trim"],"sources":["../../../../src/internal/http/middleware.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/internal/http/multipart.js b/dist/esm/internal/http/multipart.js
index 406f97e46bf357859a68416e964706dbf0107f37..97530e7cee88ff67e6467e96ebfcab7a2950c68e 100644
--- a/dist/esm/internal/http/multipart.js
+++ b/dist/esm/internal/http/multipart.js
@@ -50,11 +50,17 @@ export const withMaxFileSize = /*#__PURE__*/dual(2, (effect, size) => Effect.loc
 export const fieldMimeTypes = /*#__PURE__*/globalValue("@effect/platform/Http/Multipart/fieldMimeTypes", () => FiberRef.unsafeMake(Chunk.make("application/json")));
 /** @internal */
 export const withFieldMimeTypes = /*#__PURE__*/dual(2, (effect, mimeTypes) => Effect.locally(effect, fieldMimeTypes, Chunk.fromIterable(mimeTypes)));
-const fileSchema = /*#__PURE__*/Schema.declare(isPersistedFile, {
+/** @internal */
+export const FileSchema = /*#__PURE__*/Schema.declare(isPersistedFile, {
   identifier: "PersistedFile"
 });
 /** @internal */
-export const filesSchema = /*#__PURE__*/Schema.Array(fileSchema);
+export const FilesSchema = /*#__PURE__*/Schema.Array(FileSchema);
+/** @internal */
+export const SingleFileSchema = /*#__PURE__*/Schema.transform( /*#__PURE__*/FilesSchema.pipe( /*#__PURE__*/Schema.itemsCount(1)), FileSchema, {
+  decode: ([file]) => file,
+  encode: file => [file]
+});
 /** @internal */
 export const schemaPersisted = (schema, options) => {
   const parse = Schema.decodeUnknown(schema, options);
diff --git a/dist/esm/internal/http/multipart.js.map b/dist/esm/internal/http/multipart.js.map
index a0a495f9ee4d156f1ca3b31877ead3189a53be69..27e42ec1b805d2e78f4117dc098808854b846999 100644
--- a/dist/esm/internal/http/multipart.js.map
+++ b/dist/esm/internal/http/multipart.js.map
@@ -1 +1 @@
-{"version":3,"file":"multipart.js","names":["Schema","Cause","Channel","Chunk","Effect","FiberRef","dual","flow","pipe","globalValue","Inspectable","Option","Predicate","Queue","Stream","MP","RefailError","FileSystem","IncomingMessage","Path","TypeId","Symbol","for","isPart","u","hasProperty","isField","_tag","isFile","isPersistedFile","isTagged","ErrorTypeId","MultipartError","message","reason","maxParts","unsafeMake","none","withMaxParts","effect","count","locally","maxFieldSize","Size","withMaxFieldSize","size","maxFileSize","withMaxFileSize","map","fieldMimeTypes","make","withFieldMimeTypes","mimeTypes","fromIterable","fileSchema","declare","identifier","filesSchema","Array","schemaPersisted","schema","options","parse","decodeUnknown","persisted","schemaJson","fromJson","parseJson","field","Struct","_","makeConfig","headers","all","get","getOrUndefined","Number","maxPartSize","maxTotalSize","maxBodySize","length","undefined","info","some","contentType","includes","defaultIsFile","makeChannel","bufferSize","acquireUseRelease","bounded","config","queue","makeFromQueue","shutdown","suspend","error","partsBuffer","partsFinished","input","awaitRead","void","emit","element","offer","cause","done","_value","parser","onField","value","push","FieldImpl","name","decodeField","onFile","chunks","finished","take","zipRight","pump","chunk","unsafeFromArray","write","FileImpl","onError","error_","fail","convertError","onDone","flatMap","sync","end","forEach","buf","takeParts","parts","partsChannel","failCause","embedInput","limit","PartBase","Class","constructor","key","toJSON","_id","content","channel","filename","fromChannel","defaultWriteFile","path","file","fs","mapError","run","sink","toPersisted","stream","writeFile","Do","bind","makeTempDirectoryScoped","dir","path_","runFoldEffect","Object","create","part","succeed","join","basename","slice","isArray","PersistedFileImpl","as","catchTags","SystemError","BadArgument"],"sources":["../../../../src/internal/http/multipart.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"multipart.js","names":["Schema","Cause","Channel","Chunk","Effect","FiberRef","dual","flow","pipe","globalValue","Inspectable","Option","Predicate","Queue","Stream","MP","RefailError","FileSystem","IncomingMessage","Path","TypeId","Symbol","for","isPart","u","hasProperty","isField","_tag","isFile","isPersistedFile","isTagged","ErrorTypeId","MultipartError","message","reason","maxParts","unsafeMake","none","withMaxParts","effect","count","locally","maxFieldSize","Size","withMaxFieldSize","size","maxFileSize","withMaxFileSize","map","fieldMimeTypes","make","withFieldMimeTypes","mimeTypes","fromIterable","FileSchema","declare","identifier","FilesSchema","Array","SingleFileSchema","transform","itemsCount","decode","file","encode","schemaPersisted","schema","options","parse","decodeUnknown","persisted","schemaJson","fromJson","parseJson","field","Struct","_","makeConfig","headers","all","get","getOrUndefined","Number","maxPartSize","maxTotalSize","maxBodySize","length","undefined","info","some","contentType","includes","defaultIsFile","makeChannel","bufferSize","acquireUseRelease","bounded","config","queue","makeFromQueue","shutdown","suspend","error","partsBuffer","partsFinished","input","awaitRead","void","emit","element","offer","cause","done","_value","parser","onField","value","push","FieldImpl","name","decodeField","onFile","chunks","finished","take","zipRight","pump","chunk","unsafeFromArray","write","FileImpl","onError","error_","fail","convertError","onDone","flatMap","sync","end","forEach","buf","takeParts","parts","partsChannel","failCause","embedInput","limit","PartBase","Class","constructor","key","toJSON","_id","content","channel","filename","fromChannel","defaultWriteFile","path","fs","mapError","run","sink","toPersisted","stream","writeFile","Do","bind","makeTempDirectoryScoped","dir","path_","runFoldEffect","Object","create","part","succeed","join","basename","slice","isArray","PersistedFileImpl","as","catchTags","SystemError","BadArgument"],"sources":["../../../../src/internal/http/multipart.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/src/Http/Multipart.ts b/src/Http/Multipart.ts
index effb3b0bf6e2801e829fa952e4a35c14d9491ea6..fa7244e9560d785990c69d314e103dbd069b96b9 100644
--- a/src/Http/Multipart.ts
+++ b/src/Http/Multipart.ts
@@ -215,7 +215,22 @@ export const withFieldMimeTypes: {
  * @since 1.0.0
  * @category schema
  */
-export const filesSchema: Schema.Schema<ReadonlyArray<PersistedFile>> = internal.filesSchema
+export const FileSchema: Schema.Schema<PersistedFile> = internal.FileSchema
+
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+export const FilesSchema: Schema.Schema<ReadonlyArray<PersistedFile>> = internal.FilesSchema
+
+/**
+ * @since 1.0.0
+ * @category schema
+ */
+export const SingleFileSchema: Schema.transform<
+  Schema.Schema<ReadonlyArray<PersistedFile>>,
+  Schema.Schema<PersistedFile>
+> = internal.SingleFileSchema
 
 /**
  * @since 1.0.0
diff --git a/src/internal/http/client.ts b/src/internal/http/client.ts
index f4e9f4d28d5091e5f8f83bf60969aa6f29eabc9a..dbf6fc7f5f921dd28bcc95b259d4c612b8857b79 100644
--- a/src/internal/http/client.ts
+++ b/src/internal/http/client.ts
@@ -126,11 +126,15 @@ export const makeDefault = (
           addAbort,
           Effect.useSpan(
             `http.client ${request.method}`,
+            { kind: "client" },
             (span) => {
+              span.attribute("http.method", request.method)
+              span.attribute("http.request.method", request.method)
               span.attribute("server.address", url.origin)
               if (url.port !== "") {
                 span.attribute("server.port", +url.port)
               }
+              span.attribute("http.url", url.toString())
               span.attribute("url.full", url.toString())
               span.attribute("url.path", url.pathname)
               span.attribute("url.scheme", url.protocol.slice(0, -1))
@@ -155,6 +159,7 @@ export const makeDefault = (
                 ),
                 (response) => {
                   span.attribute("http.response.status_code", response.status)
+                  span.attribute("http.status_code", response.status)
                   const redactedHeaders = Headers.redact(response.headers, redactedHeaderNames)
                   for (const name in redactedHeaders) {
                     span.attribute(`http.response.header.${name}`, String(redactedHeaders[name]))
diff --git a/src/internal/http/middleware.ts b/src/internal/http/middleware.ts
index dfebbf1c40a4996d23ac43049cb1494c9107020a..10d0015f94cb26da50f9423189df4805ee83181d 100644
--- a/src/internal/http/middleware.ts
+++ b/src/internal/http/middleware.ts
@@ -123,10 +123,12 @@ export const tracer = make((httpApp) =>
     const redactedHeaders = Headers.redact(request.headers, redactedHeaderNames)
     return Effect.useSpan(
       `http.server ${request.method}`,
-      { parent: Option.getOrUndefined(TraceContext.fromHeaders(request.headers)) },
+      { parent: Option.getOrUndefined(TraceContext.fromHeaders(request.headers)), kind: "server" },
       (span) => {
+        span.attribute("http.method", request.method)
         span.attribute("http.request.method", request.method)
         if (url !== undefined) {
+          span.attribute("http.url", url.toString())
           span.attribute("url.full", url.toString())
           span.attribute("url.path", url.pathname)
           const query = url.search.slice(1)
@@ -149,9 +151,11 @@ export const tracer = make((httpApp) =>
           (exit) => {
             if (exit._tag === "Failure") {
               span.attribute("http.response.status_code", ServerError.causeStatusCode(exit.cause))
+              span.attribute("http.status_code", ServerError.causeStatusCode(exit.cause))
             } else {
               const response = exit.value
               span.attribute("http.response.status_code", response.status)
+              span.attribute("http.status_code", response.status)
               const redactedHeaders = Headers.redact(response.headers, redactedHeaderNames)
               for (const name in redactedHeaders) {
                 span.attribute(`http.response.header.${name}`, String(redactedHeaders[name]))
diff --git a/src/internal/http/multipart.ts b/src/internal/http/multipart.ts
index add20c09435b23d2ddcab002391cd8102472336e..e2fbaf0ed6726a1be2293ee9c341072e011ab705 100644
--- a/src/internal/http/multipart.ts
+++ b/src/internal/http/multipart.ts
@@ -100,12 +100,22 @@ export const withFieldMimeTypes = dual<
   <R, E, A>(effect: Effect.Effect<A, E, R>, mimeTypes: ReadonlyArray<string>) => Effect.Effect<A, E, R>
 >(2, (effect, mimeTypes) => Effect.locally(effect, fieldMimeTypes, Chunk.fromIterable(mimeTypes)))
 
-const fileSchema: Schema.Schema<Multipart.PersistedFile> = Schema.declare(isPersistedFile, {
+/** @internal */
+export const FileSchema: Schema.Schema<Multipart.PersistedFile> = Schema.declare(isPersistedFile, {
   identifier: "PersistedFile"
 })
 
 /** @internal */
-export const filesSchema: Schema.Schema<ReadonlyArray<Multipart.PersistedFile>> = Schema.Array(fileSchema)
+export const FilesSchema: Schema.Schema<ReadonlyArray<Multipart.PersistedFile>> = Schema.Array(FileSchema)
+
+/** @internal */
+export const SingleFileSchema: Schema.transform<
+  Schema.Schema<ReadonlyArray<Multipart.PersistedFile>>,
+  Schema.Schema<Multipart.PersistedFile>
+> = Schema.transform(FilesSchema.pipe(Schema.itemsCount(1)), FileSchema, {
+  decode: ([file]) => file,
+  encode: (file) => [file]
+})
 
 /** @internal */
 export const schemaPersisted = <R, I extends Partial<Multipart.Persisted>, A>(
