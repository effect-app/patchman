diff --git a/dist/cjs/Metrics.js.map b/dist/cjs/Metrics.js.map
index 09f4462d02753c0cc1e41314dbde5a20660e8c40..963f61014052b21a12e2add74ab480c75f66a566 100644
--- a/dist/cjs/Metrics.js.map
+++ b/dist/cjs/Metrics.js.map
@@ -1 +1 @@
-{"version":3,"file":"Metrics.js","names":["internal","_interopRequireWildcard","require","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","makeProducer","exports","registerProducer","layer"],"sources":["../../src/Metrics.ts"],"sourcesContent":[null],"mappings":";;;;;;AAQA,IAAAA,QAAA,gBAAAC,uBAAA,eAAAC,OAAA;AAAiD,SAAAC,yBAAAC,CAAA;EAAA,yBAAAC,OAAA;EAAA,IAAAC,CAAA,OAAAD,OAAA;IAAAE,CAAA,OAAAF,OAAA;EAAA,QAAAF,wBAAA,YAAAA,CAAAC,CAAA;IAAA,OAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA;EAAA,GAAAF,CAAA;AAAA;AAAA,SAAAH,wBAAAG,CAAA,EAAAE,CAAA;EAAA,KAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA;EAAA,aAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA;IAAAK,OAAA,EAAAL;EAAA;EAAA,IAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA;EAAA,IAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA;EAAA,IAAAQ,CAAA;MAAAC,SAAA;IAAA;IAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA;EAAA,SAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA;IAAA,IAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA;IAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA;EAAA;EAAA,OAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA;AAGjD;;;;AAIO,MAAMW,YAAY,GAAAC,OAAA,CAAAD,YAAA,GAAmDvB,QAAQ,CAACuB,YAAY;AAEjG;;;;AAIO,MAAME,gBAAgB,GAAAD,OAAA,CAAAC,gBAAA,GAG0BzB,QAAQ,CAACyB,gBAAgB;AAEhF;;;;AAIO,MAAMC,KAAK,GAAAF,OAAA,CAAAE,KAAA,GAAuE1B,QAAQ,CAAC0B,KAAK","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"Metrics.js","names":["internal","_interopRequireWildcard","require","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","makeProducer","exports","registerProducer","layer"],"sources":["../../src/Metrics.ts"],"sourcesContent":[null],"mappings":";;;;;;AASA,IAAAA,QAAA,gBAAAC,uBAAA,eAAAC,OAAA;AAAiD,SAAAC,yBAAAC,CAAA;EAAA,yBAAAC,OAAA;EAAA,IAAAC,CAAA,OAAAD,OAAA;IAAAE,CAAA,OAAAF,OAAA;EAAA,QAAAF,wBAAA,YAAAA,CAAAC,CAAA;IAAA,OAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA;EAAA,GAAAF,CAAA;AAAA;AAAA,SAAAH,wBAAAG,CAAA,EAAAE,CAAA;EAAA,KAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA;EAAA,aAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA;IAAAK,OAAA,EAAAL;EAAA;EAAA,IAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA;EAAA,IAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA;EAAA,IAAAQ,CAAA;MAAAC,SAAA;IAAA;IAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA;EAAA,SAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA;IAAA,IAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA;IAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA;EAAA;EAAA,OAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA;AAGjD;;;;AAIO,MAAMW,YAAY,GAAAC,OAAA,CAAAD,YAAA,GAAmDvB,QAAQ,CAACuB,YAAY;AAEjG;;;;AAIO,MAAME,gBAAgB,GAAAD,OAAA,CAAAC,gBAAA,GAGiDzB,QAAQ,CAACyB,gBAAgB;AAEvG;;;;AAIO,MAAMC,KAAK,GAAAF,OAAA,CAAAE,KAAA,GAChB1B,QAAQ,CAAC0B,KAAK","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/NodeSdk.js b/dist/cjs/NodeSdk.js
index 887c3b2140976524e16c8d445bef7c878b1531ed..d88b537a33c79cc1376d950738146293e61c34a8 100644
--- a/dist/cjs/NodeSdk.js
+++ b/dist/cjs/NodeSdk.js
@@ -39,12 +39,12 @@ function _interopRequireWildcard(e, r) {
  * @since 1.0.0
  * @category layers
  */
-const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
+const layerTracerProvider = (processors, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
   const provider = new _sdkTraceNode.NodeTracerProvider({
     ...(config ?? undefined),
     resource
   });
-  provider.addSpanProcessor(processor);
+  processors.forEach(p => provider.addSpanProcessor(p));
   return provider;
 }), provider => Effect.ignoreLogged(Effect.promise(() => provider.shutdown())))));
 /**
@@ -54,8 +54,8 @@ const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.TracerPro
 exports.layerTracerProvider = layerTracerProvider;
 const layer = evaluate => Layer.unwrapEffect(Effect.map(Effect.isEffect(evaluate) ? evaluate : Effect.sync(evaluate), config => {
   const ResourceLive = config.resource === undefined ? Resource.layerFromEnv() : Resource.layer(config.resource);
-  const TracerLive = config.spanProcessor ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessor, config.tracerConfig))) : Layer.empty;
-  const MetricsLive = config.metricReader ? Metrics.layer(() => config.metricReader) : Layer.empty;
+  const TracerLive = config.spanProcessors ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessors, config.tracerConfig))) : Layer.empty;
+  const MetricsLive = config.metricReader ? Metrics.layer(() => [config.metricReader]) : Layer.empty;
   return Layer.merge(TracerLive, MetricsLive).pipe(Layer.provideMerge(ResourceLive));
 }));
 /**
diff --git a/dist/cjs/NodeSdk.js.map b/dist/cjs/NodeSdk.js.map
index 8438f7923d60efb0752c44fdec8565112f4394d0..6dfbf7e601a824651f59a7b6691a2bb955fc045b 100644
--- a/dist/cjs/NodeSdk.js.map
+++ b/dist/cjs/NodeSdk.js.map
@@ -1 +1 @@
-{"version":3,"file":"NodeSdk.js","names":["_sdkTraceNode","require","Effect","_interopRequireWildcard","Layer","Metrics","Resource","Tracer","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","layerTracerProvider","processor","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","NodeTracerProvider","undefined","addSpanProcessor","ignoreLogged","promise","shutdown","exports","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","layerFromEnv","TracerLive","spanProcessor","pipe","provide","tracerConfig","empty","MetricsLive","metricReader","merge","provideMerge","layerEmpty"],"sources":["../../src/NodeSdk.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"NodeSdk.js","names":["_sdkTraceNode","require","Effect","_interopRequireWildcard","Layer","Metrics","Resource","Tracer","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","layerTracerProvider","processors","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","NodeTracerProvider","undefined","forEach","p","addSpanProcessor","ignoreLogged","promise","shutdown","exports","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","layerFromEnv","TracerLive","spanProcessors","pipe","provide","tracerConfig","empty","MetricsLive","metricReader","merge","provideMerge","layerEmpty"],"sources":["../../src/NodeSdk.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/WebSdk.js b/dist/cjs/WebSdk.js
index f91e70f5bba470d1125a84b0ca6c68850a6ae649..373d82f387ec92770ef5505a4b6e0016ea6efd7b 100644
--- a/dist/cjs/WebSdk.js
+++ b/dist/cjs/WebSdk.js
@@ -39,12 +39,12 @@ function _interopRequireWildcard(e, r) {
  * @since 1.0.0
  * @category layers
  */
-const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
+const layerTracerProvider = (processors, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
   const provider = new _sdkTraceWeb.WebTracerProvider({
     ...(config ?? undefined),
     resource
   });
-  provider.addSpanProcessor(processor);
+  processors.forEach(p => provider.addSpanProcessor(p));
   return provider;
 }), provider => Effect.ignoreLogged(Effect.promise(() => provider.shutdown())))));
 /**
@@ -54,8 +54,8 @@ const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.TracerPro
 exports.layerTracerProvider = layerTracerProvider;
 const layer = evaluate => Layer.unwrapEffect(Effect.map(Effect.isEffect(evaluate) ? evaluate : Effect.sync(evaluate), config => {
   const ResourceLive = Resource.layer(config.resource);
-  const TracerLive = config.spanProcessor ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessor, config.tracerConfig))) : Layer.effectDiscard(Effect.void);
-  const MetricsLive = config.metricReader ? Metrics.layer(() => config.metricReader) : Layer.effectDiscard(Effect.void);
+  const TracerLive = config.spanProcessors ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessors, config.tracerConfig))) : Layer.effectDiscard(Effect.void);
+  const MetricsLive = config.metricReaders ? Metrics.layer(() => config.metricReaders) : Layer.effectDiscard(Effect.void);
   return Layer.merge(TracerLive, MetricsLive).pipe(Layer.provideMerge(ResourceLive));
 }));
 exports.layer = layer;
diff --git a/dist/cjs/WebSdk.js.map b/dist/cjs/WebSdk.js.map
index 2d586f21ba7881b7fc288f51fb8bd0f569fb31fe..09d326051230539a8b8158cb7402c0b7ad24caea 100644
--- a/dist/cjs/WebSdk.js.map
+++ b/dist/cjs/WebSdk.js.map
@@ -1 +1 @@
-{"version":3,"file":"WebSdk.js","names":["_sdkTraceWeb","require","Effect","_interopRequireWildcard","Layer","Metrics","Resource","Tracer","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","layerTracerProvider","processor","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","WebTracerProvider","undefined","addSpanProcessor","ignoreLogged","promise","shutdown","exports","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","TracerLive","spanProcessor","pipe","provide","tracerConfig","effectDiscard","void","MetricsLive","metricReader","merge","provideMerge"],"sources":["../../src/WebSdk.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"WebSdk.js","names":["_sdkTraceWeb","require","Effect","_interopRequireWildcard","Layer","Metrics","Resource","Tracer","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","layerTracerProvider","processors","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","WebTracerProvider","undefined","forEach","p","addSpanProcessor","ignoreLogged","promise","shutdown","exports","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","TracerLive","spanProcessors","pipe","provide","tracerConfig","effectDiscard","void","MetricsLive","metricReaders","merge","provideMerge"],"sources":["../../src/WebSdk.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/internal/metrics.js b/dist/cjs/internal/metrics.js
index 899e8407e9ec9f5b02c20e02657485d4d346840b..c6d2c18404d095eee3e32b3656169bd6308a1e6d 100644
--- a/dist/cjs/internal/metrics.js
+++ b/dist/cjs/internal/metrics.js
@@ -299,10 +299,10 @@ const currentHrTime = () => {
 const makeProducer = exports.makeProducer = /*#__PURE__*/Effect.map(Resource.Resource, resource => new MetricProducerImpl(resource));
 /** @internal */
 const registerProducer = (self, metricReader) => Effect.acquireRelease(Effect.sync(() => {
-  const reader = metricReader();
-  reader.setMetricProducer(self);
-  return reader;
-}), reader => Effect.ignoreLogged(Effect.promise(() => reader.shutdown())));
+  const readers = metricReader();
+  readers.forEach(_ => _.setMetricProducer(self));
+  return readers;
+}), readers => Effect.ignoreLogged(Effect.promise(() => Promise.all(readers.map(_ => _.shutdown())))));
 /** @internal */
 exports.registerProducer = registerProducer;
 const layer = evaluate => Layer.scopedDiscard(Effect.flatMap(makeProducer, producer => registerProducer(producer, evaluate)));
diff --git a/dist/cjs/internal/metrics.js.map b/dist/cjs/internal/metrics.js.map
index df1c9b41702bae96f8ff174c54e544a466d50047..7e4a6674a986ac75890f8e2c3300dc6dde226752 100644
--- a/dist/cjs/internal/metrics.js.map
+++ b/dist/cjs/internal/metrics.js.map
@@ -1 +1 @@
-{"version":3,"file":"metrics.js","names":["_api","require","_sdkMetrics","Arr","_interopRequireWildcard","Effect","Layer","Metric","MetricKeyType","MetricState","Option","Resource","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","sdkName","MetricProducerImpl","resource","constructor","startTimes","Map","startTimeFor","name","hrTime","collect","_options","snapshot","unsafeSnapshot","hrTimeNow","currentHrTime","metricData","metricDataByName","addMetricData","data","push","descriptor","len","length","metricKey","metricState","attributes","reduce","tags","acc","label","key","value","descriptorFromKey","startTime","isCounterState","dataPoint","endTime","Number","count","dataPoints","dataPointType","DataPointType","SUM","isMonotonic","type","InstrumentType","COUNTER","aggregationTemporality","AggregationTemporality","CUMULATIVE","isGaugeState","GAUGE","isHistogramState","size","buckets","boundaries","allocate","counts","prev","boundary","min","max","sum","HISTOGRAM","isFrequencyState","freqKey","occurrences","isSummaryState","quantile","quantiles","toString","_tag","countDataPoint","sumDataPoint","descriptorMeta","unit","valueType","ValueType","INT","DOUBLE","Promise","resolve","resourceMetrics","scopeMetrics","scope","metrics","errors","exports","suffix","description","getOrElse","time_unit","instrumentTypeFromKey","keyType","bigint","isHistogramKey","isGaugeKey","OBSERVABLE_GAUGE","isFrequencyKey","isCounterKey","incremental","UP_DOWN_COUNTER","now","Date","Math","floor","makeProducer","map","registerProducer","self","metricReader","acquireRelease","sync","reader","setMetricProducer","ignoreLogged","promise","shutdown","layer","evaluate","scopedDiscard","flatMap","producer"],"sources":["../../../src/internal/metrics.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"metrics.js","names":["_api","require","_sdkMetrics","Arr","_interopRequireWildcard","Effect","Layer","Metric","MetricKeyType","MetricState","Option","Resource","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","sdkName","MetricProducerImpl","resource","constructor","startTimes","Map","startTimeFor","name","hrTime","collect","_options","snapshot","unsafeSnapshot","hrTimeNow","currentHrTime","metricData","metricDataByName","addMetricData","data","push","descriptor","len","length","metricKey","metricState","attributes","reduce","tags","acc","label","key","value","descriptorFromKey","startTime","isCounterState","dataPoint","endTime","Number","count","dataPoints","dataPointType","DataPointType","SUM","isMonotonic","type","InstrumentType","COUNTER","aggregationTemporality","AggregationTemporality","CUMULATIVE","isGaugeState","GAUGE","isHistogramState","size","buckets","boundaries","allocate","counts","prev","boundary","min","max","sum","HISTOGRAM","isFrequencyState","freqKey","occurrences","isSummaryState","quantile","quantiles","toString","_tag","countDataPoint","sumDataPoint","descriptorMeta","unit","valueType","ValueType","INT","DOUBLE","Promise","resolve","resourceMetrics","scopeMetrics","scope","metrics","errors","exports","suffix","description","getOrElse","time_unit","instrumentTypeFromKey","keyType","bigint","isHistogramKey","isGaugeKey","OBSERVABLE_GAUGE","isFrequencyKey","isCounterKey","incremental","UP_DOWN_COUNTER","now","Date","Math","floor","makeProducer","map","registerProducer","self","metricReader","acquireRelease","sync","readers","forEach","_","setMetricProducer","ignoreLogged","promise","all","shutdown","layer","evaluate","scopedDiscard","flatMap","producer"],"sources":["../../../src/internal/metrics.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/cjs/internal/tracer.js b/dist/cjs/internal/tracer.js
index 4ff55d5eda2fa1e6b1bb489a889e959c90a1ce96..5234f0ee6b1d9ea21d28e90713952d2a6ac7a7ae 100644
--- a/dist/cjs/internal/tracer.js
+++ b/dist/cjs/internal/tracer.js
@@ -39,12 +39,20 @@ function _interopRequireWildcard(e, r) {
   return n.default = e, t && t.set(e, n), n;
 }
 const OtelSpanTypeId = /*#__PURE__*/Symbol.for("@effect/opentelemetry/Tracer/OtelSpan");
+const kindMap = {
+  "internal": OtelApi.SpanKind.INTERNAL,
+  "client": OtelApi.SpanKind.CLIENT,
+  "server": OtelApi.SpanKind.SERVER,
+  "producer": OtelApi.SpanKind.PRODUCER,
+  "consumer": OtelApi.SpanKind.CONSUMER
+};
 /** @internal */
 class OtelSpan {
   name;
   parent;
   context;
   links;
+  kind;
   [OtelSpanTypeId];
   _tag = "Span";
   span;
@@ -53,11 +61,12 @@ class OtelSpan {
   attributes = new Map();
   sampled;
   status;
-  constructor(contextApi, tracer, name, parent, context, links, startTime) {
+  constructor(contextApi, tracer, name, parent, context, links, startTime, kind) {
     this.name = name;
     this.parent = parent;
     this.context = context;
     this.links = links;
+    this.kind = kind;
     this[OtelSpanTypeId] = OtelSpanTypeId;
     const active = contextApi.active();
     this.span = tracer.startSpan(name, {
@@ -65,7 +74,8 @@ class OtelSpan {
       links: links.length > 0 ? links.map(link => ({
         context: makeSpanContext(link.span),
         attributes: recordToAttributes(link.attributes)
-      })) : undefined
+      })) : undefined,
+      kind: kindMap[this.kind]
     }, parent._tag === "Some" ? populateContext(active, parent.value, context) : OtelApi.trace.deleteSpan(active));
     const spanContext = this.span.spanContext();
     this.spanId = spanContext.spanId;
@@ -119,8 +129,8 @@ const TracerProvider = exports.TracerProvider = /*#__PURE__*/Context.GenericTag(
 const Tracer = exports.Tracer = /*#__PURE__*/Context.GenericTag("@effect/opentelemetry/Tracer/Tracer");
 /** @internal */
 const make = exports.make = /*#__PURE__*/Effect.map(Tracer, tracer => EffectTracer.make({
-  span(name, parent, context, links, startTime) {
-    return new OtelSpan(OtelApi.context, tracer, name, parent, context, links, startTime);
+  span(name, parent, context, links, startTime, kind) {
+    return new OtelSpan(OtelApi.context, tracer, name, parent, context, links, startTime, kind);
   },
   context(execution, fiber) {
     const currentSpan = fiber.getFiberRef(FiberRef.currentContext).unsafeMap.get(EffectTracer.ParentSpan.key);
diff --git a/dist/cjs/internal/tracer.js.map b/dist/cjs/internal/tracer.js.map
index a5bc195b405c58f70bae2d2feeadc71499039881..00bec9f6187592801a15b307edde0c9ae27cca0a 100644
--- a/dist/cjs/internal/tracer.js.map
+++ b/dist/cjs/internal/tracer.js.map
@@ -1 +1 @@
-{"version":3,"file":"tracer.js","names":["OtelApi","_interopRequireWildcard","require","Cause","Context","Effect","FiberRef","Layer","Option","EffectTracer","_Resource","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","OtelSpanTypeId","Symbol","for","OtelSpan","name","parent","context","links","_tag","span","spanId","traceId","attributes","Map","sampled","status","constructor","contextApi","tracer","startTime","active","startSpan","nanosToHrTime","length","map","link","makeSpanContext","recordToAttributes","undefined","populateContext","value","trace","deleteSpan","spanContext","traceFlags","TraceFlags","SAMPLED","attribute","key","setAttribute","unknownToAttributeValue","end","endTime","exit","setStatus","code","SpanStatusCode","OK","isInterruptedOnly","cause","message","pretty","ERROR","event","addEvent","exports","TracerProvider","GenericTag","Tracer","make","execution","fiber","currentSpan","getFiberRef","currentContext","unsafeMap","ParentSpan","with","traceFlagsTag","traceStateTag","makeExternalSpan","options","empty","add","traceState","match","createTraceState","onNone","onSome","currentOtelSpan","flatMap","succeed","fail","NoSuchElementException","layerGlobalProvider","sync","getTracerProvider","layerTracer","effect","zip","Resource","resource","provider","getTracer","layerGlobalTracer","pipe","provide","layerGlobal","unwrapEffect","setTracer","layer","bigint1e9","timestamp","Number","liftThrowable","otelContext","setSpan","setSpanContext","isRemote","getOrElse","extractTraceTag","getOption","getOrUndefined","tag","orElse","entries","reduce","acc","objectToAttribute","JSON","stringify","String"],"sources":["../../../src/internal/tracer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"tracer.js","names":["OtelApi","_interopRequireWildcard","require","Cause","Context","Effect","FiberRef","Layer","Option","EffectTracer","_Resource","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","OtelSpanTypeId","Symbol","for","kindMap","SpanKind","INTERNAL","CLIENT","SERVER","PRODUCER","CONSUMER","OtelSpan","name","parent","context","links","kind","_tag","span","spanId","traceId","attributes","Map","sampled","status","constructor","contextApi","tracer","startTime","active","startSpan","nanosToHrTime","length","map","link","makeSpanContext","recordToAttributes","undefined","populateContext","value","trace","deleteSpan","spanContext","traceFlags","TraceFlags","SAMPLED","attribute","key","setAttribute","unknownToAttributeValue","end","endTime","exit","setStatus","code","SpanStatusCode","OK","isInterruptedOnly","cause","message","pretty","ERROR","event","addEvent","exports","TracerProvider","GenericTag","Tracer","make","execution","fiber","currentSpan","getFiberRef","currentContext","unsafeMap","ParentSpan","with","traceFlagsTag","traceStateTag","makeExternalSpan","options","empty","add","traceState","match","createTraceState","onNone","onSome","currentOtelSpan","flatMap","succeed","fail","NoSuchElementException","layerGlobalProvider","sync","getTracerProvider","layerTracer","effect","zip","Resource","resource","provider","getTracer","layerGlobalTracer","pipe","provide","layerGlobal","unwrapEffect","setTracer","layer","bigint1e9","timestamp","Number","liftThrowable","otelContext","setSpan","setSpanContext","isRemote","getOrElse","extractTraceTag","getOption","getOrUndefined","tag","orElse","entries","reduce","acc","objectToAttribute","JSON","stringify","String"],"sources":["../../../src/internal/tracer.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,IAAAA,OAAA,gBAAAC,uBAAA,eAAAC,OAAA;AACA,IAAAC,KAAA,gBAAAF,uBAAA,eAAAC,OAAA;AACA,IAAAE,OAAA,gBAAAH,uBAAA,eAAAC,OAAA;AACA,IAAAG,MAAA,gBAAAJ,uBAAA,eAAAC,OAAA;AAEA,IAAAI,QAAA,gBAAAL,uBAAA,eAAAC,OAAA;AACA,IAAAK,KAAA,gBAAAN,uBAAA,eAAAC,OAAA;AACA,IAAAM,MAAA,gBAAAP,uBAAA,eAAAC,OAAA;AACA,IAAAO,YAAA,gBAAAR,uBAAA,eAAAC,OAAA;AACA,IAAAQ,SAAA,gBAAAR,OAAA;AAAyC,SAAAS,yBAAAC,CAAA;EAAA,yBAAAC,OAAA;EAAA,IAAAC,CAAA,OAAAD,OAAA;IAAAE,CAAA,OAAAF,OAAA;EAAA,QAAAF,wBAAA,YAAAA,CAAAC,CAAA;IAAA,OAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA;EAAA,GAAAF,CAAA;AAAA;AAAA,SAAAX,wBAAAW,CAAA,EAAAE,CAAA;EAAA,KAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA;EAAA,aAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA;IAAAK,OAAA,EAAAL;EAAA;EAAA,IAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA;EAAA,IAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA;EAAA,IAAAQ,CAAA;MAAAC,SAAA;IAAA;IAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA;EAAA,SAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA;IAAA,IAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA;IAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA;EAAA;EAAA,OAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA;AAEzC,MAAMW,cAAc,gBAAGC,MAAM,CAACC,GAAG,CAAC,uCAAuC,CAAC;AAE1E,MAAMC,OAAO,GAAG;EACd,UAAU,EAAElC,OAAO,CAACmC,QAAQ,CAACC,QAAQ;EACrC,QAAQ,EAAEpC,OAAO,CAACmC,QAAQ,CAACE,MAAM;EACjC,QAAQ,EAAErC,OAAO,CAACmC,QAAQ,CAACG,MAAM;EACjC,UAAU,EAAEtC,OAAO,CAACmC,QAAQ,CAACI,QAAQ;EACrC,UAAU,EAAEvC,OAAO,CAACmC,QAAQ,CAACK;CAC9B;AAED;AACM,MAAOC,QAAQ;EAcRC,IAAA;EACAC,MAAA;EACAC,OAAA;EACAC,KAAA;EAEAC,IAAA;EAlBF,CAACf,cAAc;EACfgB,IAAI,GAAG,MAAM;EAEbC,IAAI;EACJC,MAAM;EACNC,OAAO;EACPC,UAAU,GAAG,IAAIC,GAAG,EAAmB;EACvCC,OAAO;EAChBC,MAAM;EAENC,YACEC,UAA8B,EAC9BC,MAAsB,EACbf,IAAY,EACZC,MAA2C,EAC3CC,OAA+B,EAC/BC,KAA2C,EACpDa,SAAiB,EACRZ,IAA2B;IAL3B,KAAAJ,IAAI,GAAJA,IAAI;IACJ,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,OAAO,GAAPA,OAAO;IACP,KAAAC,KAAK,GAALA,KAAK;IAEL,KAAAC,IAAI,GAAJA,IAAI;IAEb,IAAI,CAACf,cAAc,CAAC,GAAGA,cAAc;IACrC,MAAM4B,MAAM,GAAGH,UAAU,CAACG,MAAM,EAAE;IAClC,IAAI,CAACX,IAAI,GAAGS,MAAM,CAACG,SAAS,CAC1BlB,IAAI,EACJ;MACEgB,SAAS,EAAEG,aAAa,CAACH,SAAS,CAAC;MACnCb,KAAK,EAAEA,KAAK,CAACiB,MAAM,GAAG,CAAC,GACnBjB,KAAK,CAACkB,GAAG,CAAEC,IAAI,KAAM;QACrBpB,OAAO,EAAEqB,eAAe,CAACD,IAAI,CAAChB,IAAI,CAAC;QACnCG,UAAU,EAAEe,kBAAkB,CAACF,IAAI,CAACb,UAAU;OAC/C,CAAC,CAAC,GACDgB,SAAgB;MACpBrB,IAAI,EAAEZ,OAAO,CAAC,IAAI,CAACY,IAAI;KACxB,EACDH,MAAM,CAACI,IAAI,KAAK,MAAM,GAClBqB,eAAe,CAACT,MAAM,EAAEhB,MAAM,CAAC0B,KAAK,EAAEzB,OAAO,CAAC,GAC9C5C,OAAO,CAACsE,KAAK,CAACC,UAAU,CAACZ,MAAM,CAAC,CACrC;IACD,MAAMa,WAAW,GAAG,IAAI,CAACxB,IAAI,CAACwB,WAAW,EAAE;IAC3C,IAAI,CAACvB,MAAM,GAAGuB,WAAW,CAACvB,MAAM;IAChC,IAAI,CAACC,OAAO,GAAGsB,WAAW,CAACtB,OAAO;IAClC,IAAI,CAACI,MAAM,GAAG;MACZP,IAAI,EAAE,SAAS;MACfW;KACD;IACD,IAAI,CAACL,OAAO,GAAG,CAACmB,WAAW,CAACC,UAAU,GAAGzE,OAAO,CAAC0E,UAAU,CAACC,OAAO,MAAM3E,OAAO,CAAC0E,UAAU,CAACC,OAAO;EACrG;EAEAC,SAASA,CAACC,GAAW,EAAER,KAAc;IACnC,IAAI,CAACrB,IAAI,CAAC8B,YAAY,CAACD,GAAG,EAAEE,uBAAuB,CAACV,KAAK,CAAC,CAAC;IAC3D,IAAI,CAAClB,UAAU,CAACrB,GAAG,CAAC+C,GAAG,EAAER,KAAK,CAAC;EACjC;EAEAW,GAAGA,CAACC,OAAe,EAAEC,IAA4B;IAC/C,IAAI,CAAC5B,MAAM,GAAG;MACZP,IAAI,EAAE,OAAO;MACbkC,OAAO;MACPC,IAAI;MACJxB,SAAS,EAAE,IAAI,CAACJ,MAAM,CAACI;KACxB;IAED,IAAIwB,IAAI,CAACnC,IAAI,KAAK,SAAS,EAAE;MAC3B,IAAI,CAACC,IAAI,CAACmC,SAAS,CAAC;QAClBC,IAAI,EAAEpF,OAAO,CAACqF,cAAc,CAACC;OAC9B,CAAC;IACJ,CAAC,MAAM;MACL,IAAInF,KAAK,CAACoF,iBAAiB,CAACL,IAAI,CAACM,KAAK,CAAC,EAAE;QACvC,IAAI,CAACxC,IAAI,CAACmC,SAAS,CAAC;UAClBC,IAAI,EAAEpF,OAAO,CAACqF,cAAc,CAACC,EAAE;UAC/BG,OAAO,EAAEtF,KAAK,CAACuF,MAAM,CAACR,IAAI,CAACM,KAAK;SACjC,CAAC;QACF,IAAI,CAACxC,IAAI,CAAC8B,YAAY,CAAC,YAAY,EAAE,gBAAgB,CAAC;QACtD,IAAI,CAAC9B,IAAI,CAAC8B,YAAY,CAAC,oBAAoB,EAAE,IAAI,CAAC;MACpD,CAAC,MAAM;QACL,IAAI,CAAC9B,IAAI,CAACmC,SAAS,CAAC;UAClBC,IAAI,EAAEpF,OAAO,CAACqF,cAAc,CAACM,KAAK;UAClCF,OAAO,EAAEtF,KAAK,CAACuF,MAAM,CAACR,IAAI,CAACM,KAAK;SACjC,CAAC;MACJ;IACF;IACA,IAAI,CAACxC,IAAI,CAACgC,GAAG,CAACnB,aAAa,CAACoB,OAAO,CAAC,CAAC;EACvC;EAEAW,KAAKA,CAAClD,IAAY,EAAEgB,SAAiB,EAAEP,UAAoC;IACzE,IAAI,CAACH,IAAI,CAAC6C,QAAQ,CAChBnD,IAAI,EACJS,UAAU,GAAGe,kBAAkB,CAACf,UAAU,CAAC,GAAGgB,SAAS,EACvDN,aAAa,CAACH,SAAS,CAAC,CACzB;EACH;;AAGF;AAAAoC,OAAA,CAAArD,QAAA,GAAAA,QAAA;AACO,MAAMsD,cAAc,GAAAD,OAAA,CAAAC,cAAA,gBAAG3F,OAAO,CAAC4F,UAAU,CAAyB,6CAA6C,CAAC;AAEvH;AACO,MAAMC,MAAM,GAAAH,OAAA,CAAAG,MAAA,gBAAG7F,OAAO,CAAC4F,UAAU,CAAiB,qCAAqC,CAAC;AAE/F;AACO,MAAME,IAAI,GAAAJ,OAAA,CAAAI,IAAA,gBAAG7F,MAAM,CAAC0D,GAAG,CAACkC,MAAM,EAAGxC,MAAM,IAC5ChD,YAAY,CAACyF,IAAI,CAAC;EAChBlD,IAAIA,CAACN,IAAI,EAAEC,MAAM,EAAEC,OAAO,EAAEC,KAAK,EAAEa,SAAS,EAAEZ,IAAI;IAChD,OAAO,IAAIL,QAAQ,CACjBzC,OAAO,CAAC4C,OAAO,EACfa,MAAM,EACNf,IAAI,EACJC,MAAM,EACNC,OAAO,EACPC,KAAK,EACLa,SAAS,EACTZ,IAAI,CACL;EACH,CAAC;EACDF,OAAOA,CAACuD,SAAS,EAAEC,KAAK;IACtB,MAAMC,WAAW,GAAGD,KAAK,CAACE,WAAW,CAAChG,QAAQ,CAACiG,cAAc,CAAC,CAACC,SAAS,CAACrF,GAAG,CAACV,YAAY,CAACgG,UAAU,CAAC5B,GAAG,CAE3F;IAEb,IAAIwB,WAAW,KAAKlC,SAAS,EAAE;MAC7B,OAAOgC,SAAS,EAAE;IACpB;IAEA,OAAOnG,OAAO,CAAC4C,OAAO,CAAC8D,IAAI,CACzBtC,eAAe,CAACpE,OAAO,CAAC4C,OAAO,CAACe,MAAM,EAAE,EAAE0C,WAAW,CAAC,EACtDF,SAAS,CACV;EACH;CACD,CAAC,CAAC;AAEL;AACO,MAAMQ,aAAa,GAAAb,OAAA,CAAAa,aAAA,gBAAGvG,OAAO,CAAC4F,UAAU,CAAqB,kCAAkC,CAAC;AAEvG;AACO,MAAMY,aAAa,GAAAd,OAAA,CAAAc,aAAA,gBAAGxG,OAAO,CAAC4F,UAAU,CAAqB,kCAAkC,CAAC;AAEvG;AACO,MAAMa,gBAAgB,GAAIC,OAKhC,IAA+B;EAC9B,IAAIlE,OAAO,GAAGxC,OAAO,CAAC2G,KAAK,EAAE;EAE7B,IAAID,OAAO,CAACrC,UAAU,EAAE;IACtB7B,OAAO,GAAGxC,OAAO,CAAC4G,GAAG,CAACpE,OAAO,EAAE+D,aAAa,EAAEG,OAAO,CAACrC,UAAU,CAAC;EACnE;EAEA,IAAI,OAAOqC,OAAO,CAACG,UAAU,KAAK,QAAQ,EAAE;IAC1CrE,OAAO,GAAGpC,MAAM,CAAC0G,KAAK,CAACC,gBAAgB,CAACL,OAAO,CAACG,UAAU,CAAC,EAAE;MAC3DG,MAAM,EAAEA,CAAA,KAAMxE,OAAO;MACrByE,MAAM,EAAGJ,UAAU,IAAK7G,OAAO,CAAC4G,GAAG,CAACpE,OAAO,EAAEgE,aAAa,EAAEK,UAAU;KACvE,CAAC;EACJ,CAAC,MAAM,IAAIH,OAAO,CAACG,UAAU,EAAE;IAC7BrE,OAAO,GAAGxC,OAAO,CAAC4G,GAAG,CAACpE,OAAO,EAAEgE,aAAa,EAAEE,OAAO,CAACG,UAAU,CAAC;EACnE;EAEA,OAAO;IACLlE,IAAI,EAAE,cAAc;IACpBG,OAAO,EAAE4D,OAAO,CAAC5D,OAAO;IACxBD,MAAM,EAAE6D,OAAO,CAAC7D,MAAM;IACtBI,OAAO,EAAEyD,OAAO,CAACrC,UAAU,GACvB,CAACqC,OAAO,CAACrC,UAAU,GAAGzE,OAAO,CAAC0E,UAAU,CAACC,OAAO,MAAM3E,OAAO,CAAC0E,UAAU,CAACC,OAAO,GAChF,IAAI;IACR/B;GACD;AACH,CAAC;AAED;AAAAkD,OAAA,CAAAe,gBAAA,GAAAA,gBAAA;AACO,MAAMS,eAAe,GAAAxB,OAAA,CAAAwB,eAAA,gBAAGjH,MAAM,CAACkH,OAAO,CAC3ClH,MAAM,CAACgG,WAAW,EACjBrD,IAAI,IAAI;EACP,IAAIjB,cAAc,IAAIiB,IAAI,EAAE;IAC1B,OAAO3C,MAAM,CAACmH,OAAO,CAAExE,IAAiB,CAACA,IAAI,CAAC;EAChD;EACA,OAAO3C,MAAM,CAACoH,IAAI,CAAC,IAAItH,KAAK,CAACuH,sBAAsB,EAAE,CAAC;AACxD,CAAC,CACF;AAED;AACO,MAAMC,mBAAmB,GAAA7B,OAAA,CAAA6B,mBAAA,gBAAGpH,KAAK,CAACqH,IAAI,CAC3C7B,cAAc,EACd,MAAM/F,OAAO,CAACsE,KAAK,CAACuD,iBAAiB,EAAE,CACxC;AAED;AACO,MAAMC,WAAW,GAAAhC,OAAA,CAAAgC,WAAA,gBAAGvH,KAAK,CAACwH,MAAM,CACrC9B,MAAM,eACN5F,MAAM,CAACkH,OAAO,eACZlH,MAAM,CAAC2H,GAAG,CAACtH,SAAA,CAAAuH,QAAQ,EAAElC,cAAc,CAAC,EACpC,CAAC,CAACmC,QAAQ,EAAEC,QAAQ,CAAC,KACnB9H,MAAM,CAACuH,IAAI,CAAC,MACVO,QAAQ,CAACC,SAAS,CAChBF,QAAQ,CAAC/E,UAAU,CAAC,cAAc,CAAW,EAC7C+E,QAAQ,CAAC/E,UAAU,CAAC,iBAAiB,CAAW,CACjD,CACF,CACJ,CACF;AAED;AACO,MAAMkF,iBAAiB,GAAAvC,OAAA,CAAAuC,iBAAA,gBAAGP,WAAW,CAACQ,IAAI,eAC/C/H,KAAK,CAACgI,OAAO,CAACZ,mBAAmB,CAAC,CACnC;AAED;AACO,MAAMa,WAAW,GAAA1C,OAAA,CAAA0C,WAAA,gBAAGjI,KAAK,CAACkI,YAAY,CAACpI,MAAM,CAAC0D,GAAG,CAACmC,IAAI,EAAE3F,KAAK,CAACmI,SAAS,CAAC,CAAC,CAACJ,IAAI,eACnF/H,KAAK,CAACgI,OAAO,CAACF,iBAAiB,CAAC,CACjC;AAED;AACO,MAAMM,KAAK,GAAA7C,OAAA,CAAA6C,KAAA,gBAAGpI,KAAK,CAACkI,YAAY,CAACpI,MAAM,CAAC0D,GAAG,CAACmC,IAAI,EAAE3F,KAAK,CAACmI,SAAS,CAAC,CAAC,CAACJ,IAAI,eAC7E/H,KAAK,CAACgI,OAAO,CAACT,WAAW,CAAC,CAC3B;AAED;AACA;AACA;AAEA,MAAMc,SAAS,GAAG,WAAc;AAChC,MAAM/E,aAAa,GAAIgF,SAAiB,IAAoB;EAC1D,OAAO,CAACC,MAAM,CAACD,SAAS,GAAGD,SAAS,CAAC,EAAEE,MAAM,CAACD,SAAS,GAAGD,SAAS,CAAC,CAAC;AACvE,CAAC;AAED,MAAMzB,gBAAgB,gBAAG3G,MAAM,CAACuI,aAAa,CAAC/I,OAAO,CAACmH,gBAAgB,CAAC;AAEvE,MAAM/C,eAAe,GAAGA,CACtB4E,WAA4B,EAC5BhG,IAA0B,EAC1BJ,OAAgC,KAEhCI,IAAI,YAAYP,QAAQ,GACtBzC,OAAO,CAACsE,KAAK,CAAC2E,OAAO,CAACD,WAAW,EAAEhG,IAAI,CAACA,IAAI,CAAC,GAC7ChD,OAAO,CAACsE,KAAK,CAAC4E,cAAc,CAACF,WAAW,EAAE/E,eAAe,CAACjB,IAAI,EAAEJ,OAAO,CAAC,CAAC;AAE7E,MAAMqB,eAAe,GAAGA,CAACjB,IAA0B,EAAEJ,OAAgC,MAA2B;EAC9GK,MAAM,EAAED,IAAI,CAACC,MAAM;EACnBC,OAAO,EAAEF,IAAI,CAACE,OAAO;EACrBiG,QAAQ,EAAEnG,IAAI,CAACD,IAAI,KAAK,cAAc;EACtC0B,UAAU,EAAEjE,MAAM,CAAC4I,SAAS,CAC1BxG,OAAO,GACLyG,eAAe,CAACrG,IAAI,EAAEJ,OAAO,EAAE+D,aAAa,CAAC,GAC7CvG,OAAO,CAACkJ,SAAS,CAACtG,IAAI,CAACJ,OAAO,EAAE+D,aAAa,CAAC,EAChD,MAAM3G,OAAO,CAAC0E,UAAU,CAACC,OAAO,CACjC;EACDsC,UAAU,EAAEzG,MAAM,CAAC+I,cAAc,CAC/B3G,OAAO,GACLyG,eAAe,CAACrG,IAAI,EAAEJ,OAAO,EAAEgE,aAAa,CAAC,GAC7CxG,OAAO,CAACkJ,SAAS,CAACtG,IAAI,CAACJ,OAAO,EAAEgE,aAAa,CAAC;CAEnD,CAAC;AAEF,MAAMyC,eAAe,GAAGA,CACtB1G,MAA4B,EAC5BC,OAA+B,EAC/B4G,GAAsB,KAEtBhJ,MAAM,CAACiJ,MAAM,CACXrJ,OAAO,CAACkJ,SAAS,CAAC1G,OAAO,EAAE4G,GAAG,CAAC,EAC/B,MAAMpJ,OAAO,CAACkJ,SAAS,CAAC3G,MAAM,CAACC,OAAO,EAAE4G,GAAG,CAAC,CAC7C;AAEH,MAAMtF,kBAAkB,GAAIG,KAA8B,IAAwB;EAChF,OAAO9C,MAAM,CAACmI,OAAO,CAACrF,KAAK,CAAC,CAACsF,MAAM,CAAC,CAACC,GAAG,EAAE,CAAC/E,GAAG,EAAER,KAAK,CAAC,KAAI;IACxDuF,GAAG,CAAC/E,GAAG,CAAC,GAAGE,uBAAuB,CAACV,KAAK,CAAC;IACzC,OAAOuF,GAAG;EACZ,CAAC,EAAE,EAAwB,CAAC;AAC9B,CAAC;AAED,MAAM7E,uBAAuB,GAAIV,KAAc,IAA4B;EACzE,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,OAAOA,KAAK,KAAK,SAAS,EAAE;IACxF,OAAOA,KAAK;EACd,CAAC,MAAM,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IACpC,OAAOyE,MAAM,CAACzE,KAAK,CAAC;EACtB;EAEA,OAAOwF,iBAAiB,CAACxF,KAAK,CAAC;AACjC,CAAC;AAED,MAAMwF,iBAAiB,GAAIxF,KAAc,IAAY;EACnD,IAAI;IACF,OAAOyF,IAAI,CAACC,SAAS,CAAC1F,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;EACvC,CAAC,CAAC,MAAM;IACN,OAAO2F,MAAM,CAAC3F,KAAK,CAAC;EACtB;AACF,CAAC","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/dts/Metrics.d.ts b/dist/dts/Metrics.d.ts
index 7f3d91cde65cb845a1c9ecd01263980d8f0b68a2..4bf37aff9244b3c5f0bcc646235d08f078b930be 100644
--- a/dist/dts/Metrics.d.ts
+++ b/dist/dts/Metrics.d.ts
@@ -2,6 +2,7 @@
  * @since 1.0.0
  */
 import type { MetricProducer, MetricReader } from "@opentelemetry/sdk-metrics";
+import type { NonEmptyReadonlyArray } from "effect/Array";
 import type * as Effect from "effect/Effect";
 import type { LazyArg } from "effect/Function";
 import type { Layer } from "effect/Layer";
@@ -16,10 +17,10 @@ export declare const makeProducer: Effect.Effect<MetricProducer, never, Resource
  * @since 1.0.0
  * @category producer
  */
-export declare const registerProducer: (self: MetricProducer, metricReader: LazyArg<MetricReader>) => Effect.Effect<MetricReader, never, Scope.Scope>;
+export declare const registerProducer: (self: MetricProducer, metricReaders: LazyArg<NonEmptyReadonlyArray<MetricReader>>) => Effect.Effect<NonEmptyReadonlyArray<MetricReader>, never, Scope.Scope>;
 /**
  * @since 1.0.0
  * @category layers
  */
-export declare const layer: (evaluate: LazyArg<MetricReader>) => Layer<never, never, Resource>;
+export declare const layer: (evaluate: LazyArg<NonEmptyReadonlyArray<MetricReader>>) => Layer<never, never, Resource>;
 //# sourceMappingURL=Metrics.d.ts.map
\ No newline at end of file
diff --git a/dist/dts/Metrics.d.ts.map b/dist/dts/Metrics.d.ts.map
index 9861432c0a3808136c820631f0438d9bbf0c7f47..5bb987bf670c9032b6d3c24e61288ef26eaf8cd9 100644
--- a/dist/dts/Metrics.d.ts.map
+++ b/dist/dts/Metrics.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"Metrics.d.ts","sourceRoot":"","sources":["../../src/Metrics.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,OAAO,KAAK,EAAE,cAAc,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAA;AAC9E,OAAO,KAAK,KAAK,MAAM,MAAM,eAAe,CAAA;AAC5C,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAC9C,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,cAAc,CAAA;AACzC,OAAO,KAAK,KAAK,KAAK,MAAM,cAAc,CAAA;AAE1C,OAAO,KAAK,EAAE,QAAQ,EAAE,MAAM,eAAe,CAAA;AAE7C;;;GAGG;AACH,eAAO,MAAM,YAAY,EAAE,MAAM,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,EAAE,QAAQ,CAAyB,CAAA;AAEjG;;;GAGG;AACH,eAAO,MAAM,gBAAgB,EAAE,CAC7B,IAAI,EAAE,cAAc,EACpB,YAAY,EAAE,OAAO,CAAC,YAAY,CAAC,KAChC,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,KAAK,EAAE,KAAK,CAAC,KAAK,CAA6B,CAAA;AAEhF;;;GAGG;AACH,eAAO,MAAM,KAAK,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,YAAY,CAAC,KAAK,KAAK,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,CAAkB,CAAA"}
\ No newline at end of file
+{"version":3,"file":"Metrics.d.ts","sourceRoot":"","sources":["../../src/Metrics.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,OAAO,KAAK,EAAE,cAAc,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAA;AAC9E,OAAO,KAAK,EAAE,qBAAqB,EAAE,MAAM,cAAc,CAAA;AACzD,OAAO,KAAK,KAAK,MAAM,MAAM,eAAe,CAAA;AAC5C,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAC9C,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,cAAc,CAAA;AACzC,OAAO,KAAK,KAAK,KAAK,MAAM,cAAc,CAAA;AAE1C,OAAO,KAAK,EAAE,QAAQ,EAAE,MAAM,eAAe,CAAA;AAE7C;;;GAGG;AACH,eAAO,MAAM,YAAY,EAAE,MAAM,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,EAAE,QAAQ,CAAyB,CAAA;AAEjG;;;GAGG;AACH,eAAO,MAAM,gBAAgB,EAAE,CAC7B,IAAI,EAAE,cAAc,EACpB,aAAa,EAAE,OAAO,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC,KACxD,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC,YAAY,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,KAAK,CAA6B,CAAA;AAEvG;;;GAGG;AACH,eAAO,MAAM,KAAK,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC,KAAK,KAAK,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,CAC5F,CAAA"}
\ No newline at end of file
diff --git a/dist/dts/NodeSdk.d.ts b/dist/dts/NodeSdk.d.ts
index d5decbc3e5315a72b7b7680304ed69e66e869294..a5885cf831afe15d15e653c5886c7cd8b064491e 100644
--- a/dist/dts/NodeSdk.d.ts
+++ b/dist/dts/NodeSdk.d.ts
@@ -5,6 +5,7 @@ import type { TracerProvider } from "@opentelemetry/api";
 import type * as Resources from "@opentelemetry/resources";
 import type { MetricReader } from "@opentelemetry/sdk-metrics";
 import type { SpanProcessor, TracerConfig } from "@opentelemetry/sdk-trace-base";
+import type { NonEmptyReadonlyArray } from "effect/Array";
 import * as Effect from "effect/Effect";
 import type { LazyArg } from "effect/Function";
 import * as Layer from "effect/Layer";
@@ -14,7 +15,7 @@ import * as Resource from "./Resource.js";
  * @category model
  */
 export interface Configuration {
-    readonly spanProcessor?: SpanProcessor | undefined;
+    readonly spanProcessors?: NonEmptyReadonlyArray<SpanProcessor> | undefined;
     readonly tracerConfig?: Omit<TracerConfig, "resource"> | undefined;
     readonly metricReader?: MetricReader | undefined;
     readonly resource?: {
@@ -27,7 +28,7 @@ export interface Configuration {
  * @since 1.0.0
  * @category layers
  */
-export declare const layerTracerProvider: (processor: SpanProcessor, config?: Omit<TracerConfig, "resource">) => Layer.Layer<TracerProvider, never, Resource.Resource>;
+export declare const layerTracerProvider: (processors: ReadonlyArray<SpanProcessor>, config?: Omit<TracerConfig, "resource">) => Layer.Layer<TracerProvider, never, Resource.Resource>;
 /**
  * @since 1.0.0
  * @category layer
diff --git a/dist/dts/NodeSdk.d.ts.map b/dist/dts/NodeSdk.d.ts.map
index ab0c29eb258c07d11310e62ef4c0fcd98d48163e..d72d1114abfa7fc572534fdd06c8fc2c229b0e0c 100644
--- a/dist/dts/NodeSdk.d.ts.map
+++ b/dist/dts/NodeSdk.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"NodeSdk.d.ts","sourceRoot":"","sources":["../../src/NodeSdk.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,OAAO,KAAK,EAAE,cAAc,EAAE,MAAM,oBAAoB,CAAA;AACxD,OAAO,KAAK,KAAK,SAAS,MAAM,0BAA0B,CAAA;AAC1D,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAA;AAC9D,OAAO,KAAK,EAAE,aAAa,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAA;AAEhF,OAAO,KAAK,MAAM,MAAM,eAAe,CAAA;AACvC,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAC9C,OAAO,KAAK,KAAK,MAAM,cAAc,CAAA;AAErC,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAA;AAGzC;;;GAGG;AACH,MAAM,WAAW,aAAa;IAC5B,QAAQ,CAAC,aAAa,CAAC,EAAE,aAAa,GAAG,SAAS,CAAA;IAClD,QAAQ,CAAC,YAAY,CAAC,EAAE,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,GAAG,SAAS,CAAA;IAClE,QAAQ,CAAC,YAAY,CAAC,EAAE,YAAY,GAAG,SAAS,CAAA;IAChD,QAAQ,CAAC,QAAQ,CAAC,EAAE;QAClB,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAA;QAC5B,QAAQ,CAAC,cAAc,CAAC,EAAE,MAAM,CAAA;QAChC,QAAQ,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,kBAAkB,CAAA;KACnD,GAAG,SAAS,CAAA;CACd;AAED;;;GAGG;AACH,eAAO,MAAM,mBAAmB,cACnB,aAAa,WACf,KAAK,YAAY,EAAE,UAAU,CAAC,KACtC,MAAM,KAAK,CAAC,cAAc,EAAE,KAAK,EAAE,SAAS,QAAQ,CAkBpD,CAAA;AAEH;;;GAGG;AACH,eAAO,MAAM,KAAK,EAAE;IAClB,CAAC,QAAQ,EAAE,OAAO,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAClE,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CA0BzF,CAAA;AAEH;;;GAGG;AACH,eAAO,MAAM,UAAU,EAAE,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAuB,CAAA"}
\ No newline at end of file
+{"version":3,"file":"NodeSdk.d.ts","sourceRoot":"","sources":["../../src/NodeSdk.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,OAAO,KAAK,EAAE,cAAc,EAAE,MAAM,oBAAoB,CAAA;AACxD,OAAO,KAAK,KAAK,SAAS,MAAM,0BAA0B,CAAA;AAC1D,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAA;AAC9D,OAAO,KAAK,EAAE,aAAa,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAA;AAEhF,OAAO,KAAK,EAAE,qBAAqB,EAAE,MAAM,cAAc,CAAA;AACzD,OAAO,KAAK,MAAM,MAAM,eAAe,CAAA;AACvC,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAC9C,OAAO,KAAK,KAAK,MAAM,cAAc,CAAA;AAErC,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAA;AAGzC;;;GAGG;AACH,MAAM,WAAW,aAAa;IAC5B,QAAQ,CAAC,cAAc,CAAC,EAAE,qBAAqB,CAAC,aAAa,CAAC,GAAG,SAAS,CAAA;IAC1E,QAAQ,CAAC,YAAY,CAAC,EAAE,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,GAAG,SAAS,CAAA;IAClE,QAAQ,CAAC,YAAY,CAAC,EAAE,YAAY,GAAG,SAAS,CAAA;IAChD,QAAQ,CAAC,QAAQ,CAAC,EAAE;QAClB,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAA;QAC5B,QAAQ,CAAC,cAAc,CAAC,EAAE,MAAM,CAAA;QAChC,QAAQ,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,kBAAkB,CAAA;KACnD,GAAG,SAAS,CAAA;CACd;AAED;;;GAGG;AACH,eAAO,MAAM,mBAAmB,eAClB,cAAc,aAAa,CAAC,WAC/B,KAAK,YAAY,EAAE,UAAU,CAAC,KACtC,MAAM,KAAK,CAAC,cAAc,EAAE,KAAK,EAAE,SAAS,QAAQ,CAkBpD,CAAA;AAEH;;;GAGG;AACH,eAAO,MAAM,KAAK,EAAE;IAClB,CAAC,QAAQ,EAAE,OAAO,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAClE,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CA0BzF,CAAA;AAEH;;;GAGG;AACH,eAAO,MAAM,UAAU,EAAE,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAuB,CAAA"}
\ No newline at end of file
diff --git a/dist/dts/WebSdk.d.ts b/dist/dts/WebSdk.d.ts
index a136e3a6a50b546f8a9b27f9546babdac4fe5ce6..033ea70b7d25377a6ce9d44f9dedc73eaed84bd3 100644
--- a/dist/dts/WebSdk.d.ts
+++ b/dist/dts/WebSdk.d.ts
@@ -5,6 +5,7 @@ import type { TracerProvider } from "@opentelemetry/api";
 import type * as Resources from "@opentelemetry/resources";
 import type { MetricReader } from "@opentelemetry/sdk-metrics";
 import type { SpanProcessor, TracerConfig } from "@opentelemetry/sdk-trace-base";
+import type { NonEmptyReadonlyArray } from "effect/Array";
 import * as Effect from "effect/Effect";
 import type { LazyArg } from "effect/Function";
 import * as Layer from "effect/Layer";
@@ -14,9 +15,9 @@ import * as Resource from "./Resource.js";
  * @category model
  */
 export interface Configuration {
-    readonly spanProcessor?: SpanProcessor;
+    readonly spanProcessors?: NonEmptyReadonlyArray<SpanProcessor>;
     readonly tracerConfig?: Omit<TracerConfig, "resource">;
-    readonly metricReader?: MetricReader;
+    readonly metricReaders?: NonEmptyReadonlyArray<MetricReader>;
     readonly resource: {
         readonly serviceName: string;
         readonly serviceVersion?: string;
@@ -27,7 +28,7 @@ export interface Configuration {
  * @since 1.0.0
  * @category layers
  */
-export declare const layerTracerProvider: (processor: SpanProcessor, config?: Omit<TracerConfig, "resource">) => Layer.Layer<TracerProvider, never, Resource.Resource>;
+export declare const layerTracerProvider: (processors: readonly [SpanProcessor, ...SpanProcessor[]], config?: Omit<TracerConfig, "resource">) => Layer.Layer<TracerProvider, never, Resource.Resource>;
 /**
  * @since 1.0.0
  * @category layer
diff --git a/dist/dts/WebSdk.d.ts.map b/dist/dts/WebSdk.d.ts.map
index 1fa8e1ab9d6f34822bbba9cb43bfad8eb50a39d1..1e6ac5138746cc6f374c3b381fbeb785e5364688 100644
--- a/dist/dts/WebSdk.d.ts.map
+++ b/dist/dts/WebSdk.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"WebSdk.d.ts","sourceRoot":"","sources":["../../src/WebSdk.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,OAAO,KAAK,EAAE,cAAc,EAAE,MAAM,oBAAoB,CAAA;AACxD,OAAO,KAAK,KAAK,SAAS,MAAM,0BAA0B,CAAA;AAC1D,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAA;AAC9D,OAAO,KAAK,EAAE,aAAa,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAA;AAEhF,OAAO,KAAK,MAAM,MAAM,eAAe,CAAA;AACvC,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAC9C,OAAO,KAAK,KAAK,MAAM,cAAc,CAAA;AAErC,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAA;AAGzC;;;GAGG;AACH,MAAM,WAAW,aAAa;IAC5B,QAAQ,CAAC,aAAa,CAAC,EAAE,aAAa,CAAA;IACtC,QAAQ,CAAC,YAAY,CAAC,EAAE,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,CAAA;IACtD,QAAQ,CAAC,YAAY,CAAC,EAAE,YAAY,CAAA;IACpC,QAAQ,CAAC,QAAQ,EAAE;QACjB,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAA;QAC5B,QAAQ,CAAC,cAAc,CAAC,EAAE,MAAM,CAAA;QAChC,QAAQ,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,kBAAkB,CAAA;KACnD,CAAA;CACF;AAED;;;GAGG;AACH,eAAO,MAAM,mBAAmB,cACnB,aAAa,WACf,KAAK,YAAY,EAAE,UAAU,CAAC,KACtC,MAAM,KAAK,CAAC,cAAc,EAAE,KAAK,EAAE,SAAS,QAAQ,CAkBpD,CAAA;AAEH;;;GAGG;AACH,eAAO,MAAM,KAAK,EAAE;IAClB,CAAC,QAAQ,EAAE,OAAO,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAClE,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAsBzF,CAAA"}
\ No newline at end of file
+{"version":3,"file":"WebSdk.d.ts","sourceRoot":"","sources":["../../src/WebSdk.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,OAAO,KAAK,EAAE,cAAc,EAAE,MAAM,oBAAoB,CAAA;AACxD,OAAO,KAAK,KAAK,SAAS,MAAM,0BAA0B,CAAA;AAC1D,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,4BAA4B,CAAA;AAC9D,OAAO,KAAK,EAAE,aAAa,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAA;AAEhF,OAAO,KAAK,EAAE,qBAAqB,EAAE,MAAM,cAAc,CAAA;AACzD,OAAO,KAAK,MAAM,MAAM,eAAe,CAAA;AACvC,OAAO,KAAK,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAA;AAC9C,OAAO,KAAK,KAAK,MAAM,cAAc,CAAA;AAErC,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAA;AAGzC;;;GAGG;AACH,MAAM,WAAW,aAAa;IAC5B,QAAQ,CAAC,cAAc,CAAC,EAAE,qBAAqB,CAAC,aAAa,CAAC,CAAA;IAC9D,QAAQ,CAAC,YAAY,CAAC,EAAE,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,CAAA;IACtD,QAAQ,CAAC,aAAa,CAAC,EAAE,qBAAqB,CAAC,YAAY,CAAC,CAAA;IAC5D,QAAQ,CAAC,QAAQ,EAAE;QACjB,QAAQ,CAAC,WAAW,EAAE,MAAM,CAAA;QAC5B,QAAQ,CAAC,cAAc,CAAC,EAAE,MAAM,CAAA;QAChC,QAAQ,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,kBAAkB,CAAA;KACnD,CAAA;CACF;AAED;;;GAGG;AACH,eAAO,MAAM,mBAAmB,sEAErB,KAAK,YAAY,EAAE,UAAU,CAAC,KACtC,MAAM,KAAK,CAAC,cAAc,EAAE,KAAK,EAAE,SAAS,QAAQ,CAkBpD,CAAA;AAEH;;;GAGG;AACH,eAAO,MAAM,KAAK,EAAE;IAClB,CAAC,QAAQ,EAAE,OAAO,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAClE,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,aAAa,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;CAsBzF,CAAA"}
\ No newline at end of file
diff --git a/dist/esm/Metrics.js.map b/dist/esm/Metrics.js.map
index d3a56e58c433b94a42ee21ffbab703872ebe6a38..8a89aca3a96d0a827da9713a48f95750309c61fa 100644
--- a/dist/esm/Metrics.js.map
+++ b/dist/esm/Metrics.js.map
@@ -1 +1 @@
-{"version":3,"file":"Metrics.js","names":["internal","makeProducer","registerProducer","layer"],"sources":["../../src/Metrics.ts"],"sourcesContent":[null],"mappings":"AAQA,OAAO,KAAKA,QAAQ,MAAM,uBAAuB;AAGjD;;;;AAIA,OAAO,MAAMC,YAAY,GAAmDD,QAAQ,CAACC,YAAY;AAEjG;;;;AAIA,OAAO,MAAMC,gBAAgB,GAG0BF,QAAQ,CAACE,gBAAgB;AAEhF;;;;AAIA,OAAO,MAAMC,KAAK,GAAuEH,QAAQ,CAACG,KAAK","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"Metrics.js","names":["internal","makeProducer","registerProducer","layer"],"sources":["../../src/Metrics.ts"],"sourcesContent":[null],"mappings":"AASA,OAAO,KAAKA,QAAQ,MAAM,uBAAuB;AAGjD;;;;AAIA,OAAO,MAAMC,YAAY,GAAmDD,QAAQ,CAACC,YAAY;AAEjG;;;;AAIA,OAAO,MAAMC,gBAAgB,GAGiDF,QAAQ,CAACE,gBAAgB;AAEvG;;;;AAIA,OAAO,MAAMC,KAAK,GAChBH,QAAQ,CAACG,KAAK","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/NodeSdk.js b/dist/esm/NodeSdk.js
index 8801ddadb200e75b2c988006d7bc97a2f6b6ac0b..01b4c5706dddb2605ebfe28e0bf4cc1cce6fe380 100644
--- a/dist/esm/NodeSdk.js
+++ b/dist/esm/NodeSdk.js
@@ -8,12 +8,12 @@ import * as Tracer from "./Tracer.js";
  * @since 1.0.0
  * @category layers
  */
-export const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
+export const layerTracerProvider = (processors, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
   const provider = new NodeTracerProvider({
     ...(config ?? undefined),
     resource
   });
-  provider.addSpanProcessor(processor);
+  processors.forEach(p => provider.addSpanProcessor(p));
   return provider;
 }), provider => Effect.ignoreLogged(Effect.promise(() => provider.shutdown())))));
 /**
@@ -22,8 +22,8 @@ export const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.Tr
  */
 export const layer = evaluate => Layer.unwrapEffect(Effect.map(Effect.isEffect(evaluate) ? evaluate : Effect.sync(evaluate), config => {
   const ResourceLive = config.resource === undefined ? Resource.layerFromEnv() : Resource.layer(config.resource);
-  const TracerLive = config.spanProcessor ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessor, config.tracerConfig))) : Layer.empty;
-  const MetricsLive = config.metricReader ? Metrics.layer(() => config.metricReader) : Layer.empty;
+  const TracerLive = config.spanProcessors ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessors, config.tracerConfig))) : Layer.empty;
+  const MetricsLive = config.metricReader ? Metrics.layer(() => [config.metricReader]) : Layer.empty;
   return Layer.merge(TracerLive, MetricsLive).pipe(Layer.provideMerge(ResourceLive));
 }));
 /**
diff --git a/dist/esm/NodeSdk.js.map b/dist/esm/NodeSdk.js.map
index 4d12017732c68d9d4b4e81d9d8cef050416d511e..65fbaf51129ad8c6c7a3684e5bb0aeea367ff3be 100644
--- a/dist/esm/NodeSdk.js.map
+++ b/dist/esm/NodeSdk.js.map
@@ -1 +1 @@
-{"version":3,"file":"NodeSdk.js","names":["NodeTracerProvider","Effect","Layer","Metrics","Resource","Tracer","layerTracerProvider","processor","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","undefined","addSpanProcessor","ignoreLogged","promise","shutdown","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","layerFromEnv","TracerLive","spanProcessor","pipe","provide","tracerConfig","empty","MetricsLive","metricReader","merge","provideMerge","layerEmpty"],"sources":["../../src/NodeSdk.ts"],"sourcesContent":[null],"mappings":"AAOA,SAASA,kBAAkB,QAAQ,+BAA+B;AAClE,OAAO,KAAKC,MAAM,MAAM,eAAe;AAEvC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,OAAO,KAAKC,OAAO,MAAM,cAAc;AACvC,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,OAAO,KAAKC,MAAM,MAAM,aAAa;AAiBrC;;;;AAIA,OAAO,MAAMC,mBAAmB,GAAGA,CACjCC,SAAwB,EACxBC,MAAuC,KAEvCN,KAAK,CAACO,MAAM,CACVJ,MAAM,CAACK,cAAc,EACrBT,MAAM,CAACU,OAAO,CACZP,QAAQ,CAACA,QAAQ,EAChBQ,QAAQ,IACPX,MAAM,CAACY,cAAc,CACnBZ,MAAM,CAACa,IAAI,CAAC,MAAK;EACf,MAAMC,QAAQ,GAAG,IAAIf,kBAAkB,CAAC;IACtC,IAAIQ,MAAM,IAAIQ,SAAS,CAAC;IACxBJ;GACD,CAAC;EACFG,QAAQ,CAACE,gBAAgB,CAACV,SAAS,CAAC;EACpC,OAAOQ,QAAQ;AACjB,CAAC,CAAC,EACDA,QAAQ,IAAKd,MAAM,CAACiB,YAAY,CAACjB,MAAM,CAACkB,OAAO,CAAC,MAAMJ,QAAQ,CAACK,QAAQ,EAAE,CAAC,CAAC,CAC7E,CACJ,CACF;AAEH;;;;AAIA,OAAO,MAAMC,KAAK,GAIhBC,QAAyE,IAEzEpB,KAAK,CAACqB,YAAY,CAChBtB,MAAM,CAACuB,GAAG,CACRvB,MAAM,CAACwB,QAAQ,CAACH,QAAQ,CAAC,GACrBA,QAAwC,GACxCrB,MAAM,CAACa,IAAI,CAACQ,QAAQ,CAAC,EACxBd,MAAM,IAAI;EACT,MAAMkB,YAAY,GAAGlB,MAAM,CAACI,QAAQ,KAAKI,SAAS,GAC9CZ,QAAQ,CAACuB,YAAY,EAAE,GACvBvB,QAAQ,CAACiB,KAAK,CAACb,MAAM,CAACI,QAAQ,CAAC;EACnC,MAAMgB,UAAU,GAAGpB,MAAM,CAACqB,aAAa,GACrCxB,MAAM,CAACgB,KAAK,CAACS,IAAI,CACf5B,KAAK,CAAC6B,OAAO,CAACzB,mBAAmB,CAACE,MAAM,CAACqB,aAAa,EAAErB,MAAM,CAACwB,YAAY,CAAC,CAAC,CAC9E,GACC9B,KAAK,CAAC+B,KAAK;EACf,MAAMC,WAAW,GAAG1B,MAAM,CAAC2B,YAAY,GACnChC,OAAO,CAACkB,KAAK,CAAC,MAAMb,MAAM,CAAC2B,YAAa,CAAC,GACzCjC,KAAK,CAAC+B,KAAK;EACf,OAAO/B,KAAK,CAACkC,KAAK,CAACR,UAAU,EAAEM,WAAW,CAAC,CAACJ,IAAI,CAC9C5B,KAAK,CAACmC,YAAY,CAACX,YAAY,CAAC,CACjC;AACH,CAAC,CACF,CACF;AAEH;;;;AAIA,OAAO,MAAMY,UAAU,GAAmClC,QAAQ,CAACkC,UAAU","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"NodeSdk.js","names":["NodeTracerProvider","Effect","Layer","Metrics","Resource","Tracer","layerTracerProvider","processors","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","undefined","forEach","p","addSpanProcessor","ignoreLogged","promise","shutdown","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","layerFromEnv","TracerLive","spanProcessors","pipe","provide","tracerConfig","empty","MetricsLive","metricReader","merge","provideMerge","layerEmpty"],"sources":["../../src/NodeSdk.ts"],"sourcesContent":[null],"mappings":"AAOA,SAASA,kBAAkB,QAAQ,+BAA+B;AAElE,OAAO,KAAKC,MAAM,MAAM,eAAe;AAEvC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,OAAO,KAAKC,OAAO,MAAM,cAAc;AACvC,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,OAAO,KAAKC,MAAM,MAAM,aAAa;AAiBrC;;;;AAIA,OAAO,MAAMC,mBAAmB,GAAGA,CACjCC,UAAwC,EACxCC,MAAuC,KAEvCN,KAAK,CAACO,MAAM,CACVJ,MAAM,CAACK,cAAc,EACrBT,MAAM,CAACU,OAAO,CACZP,QAAQ,CAACA,QAAQ,EAChBQ,QAAQ,IACPX,MAAM,CAACY,cAAc,CACnBZ,MAAM,CAACa,IAAI,CAAC,MAAK;EACf,MAAMC,QAAQ,GAAG,IAAIf,kBAAkB,CAAC;IACtC,IAAIQ,MAAM,IAAIQ,SAAS,CAAC;IACxBJ;GACD,CAAC;EACFL,UAAU,CAACU,OAAO,CAAEC,CAAC,IAAKH,QAAQ,CAACI,gBAAgB,CAACD,CAAC,CAAC,CAAC;EACvD,OAAOH,QAAQ;AACjB,CAAC,CAAC,EACDA,QAAQ,IAAKd,MAAM,CAACmB,YAAY,CAACnB,MAAM,CAACoB,OAAO,CAAC,MAAMN,QAAQ,CAACO,QAAQ,EAAE,CAAC,CAAC,CAC7E,CACJ,CACF;AAEH;;;;AAIA,OAAO,MAAMC,KAAK,GAIhBC,QAAyE,IAEzEtB,KAAK,CAACuB,YAAY,CAChBxB,MAAM,CAACyB,GAAG,CACRzB,MAAM,CAAC0B,QAAQ,CAACH,QAAQ,CAAC,GACrBA,QAAwC,GACxCvB,MAAM,CAACa,IAAI,CAACU,QAAQ,CAAC,EACxBhB,MAAM,IAAI;EACT,MAAMoB,YAAY,GAAGpB,MAAM,CAACI,QAAQ,KAAKI,SAAS,GAC9CZ,QAAQ,CAACyB,YAAY,EAAE,GACvBzB,QAAQ,CAACmB,KAAK,CAACf,MAAM,CAACI,QAAQ,CAAC;EACnC,MAAMkB,UAAU,GAAGtB,MAAM,CAACuB,cAAc,GACtC1B,MAAM,CAACkB,KAAK,CAACS,IAAI,CACf9B,KAAK,CAAC+B,OAAO,CAAC3B,mBAAmB,CAACE,MAAM,CAACuB,cAAc,EAAEvB,MAAM,CAAC0B,YAAY,CAAC,CAAC,CAC/E,GACChC,KAAK,CAACiC,KAAK;EACf,MAAMC,WAAW,GAAG5B,MAAM,CAAC6B,YAAY,GACnClC,OAAO,CAACoB,KAAK,CAAC,MAAM,CAACf,MAAM,CAAC6B,YAAa,CAAC,CAAC,GAC3CnC,KAAK,CAACiC,KAAK;EACf,OAAOjC,KAAK,CAACoC,KAAK,CAACR,UAAU,EAAEM,WAAW,CAAC,CAACJ,IAAI,CAC9C9B,KAAK,CAACqC,YAAY,CAACX,YAAY,CAAC,CACjC;AACH,CAAC,CACF,CACF;AAEH;;;;AAIA,OAAO,MAAMY,UAAU,GAAmCpC,QAAQ,CAACoC,UAAU","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/WebSdk.js b/dist/esm/WebSdk.js
index 01fa95ca2bffd51d00aee31cb80f5a10657df4c3..cd0481b4c50e9a431611f33dea2244bfb83d6c12 100644
--- a/dist/esm/WebSdk.js
+++ b/dist/esm/WebSdk.js
@@ -8,12 +8,12 @@ import * as Tracer from "./Tracer.js";
  * @since 1.0.0
  * @category layers
  */
-export const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
+export const layerTracerProvider = (processors, config) => Layer.scoped(Tracer.TracerProvider, Effect.flatMap(Resource.Resource, resource => Effect.acquireRelease(Effect.sync(() => {
   const provider = new WebTracerProvider({
     ...(config ?? undefined),
     resource
   });
-  provider.addSpanProcessor(processor);
+  processors.forEach(p => provider.addSpanProcessor(p));
   return provider;
 }), provider => Effect.ignoreLogged(Effect.promise(() => provider.shutdown())))));
 /**
@@ -22,8 +22,8 @@ export const layerTracerProvider = (processor, config) => Layer.scoped(Tracer.Tr
  */
 export const layer = evaluate => Layer.unwrapEffect(Effect.map(Effect.isEffect(evaluate) ? evaluate : Effect.sync(evaluate), config => {
   const ResourceLive = Resource.layer(config.resource);
-  const TracerLive = config.spanProcessor ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessor, config.tracerConfig))) : Layer.effectDiscard(Effect.void);
-  const MetricsLive = config.metricReader ? Metrics.layer(() => config.metricReader) : Layer.effectDiscard(Effect.void);
+  const TracerLive = config.spanProcessors ? Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessors, config.tracerConfig))) : Layer.effectDiscard(Effect.void);
+  const MetricsLive = config.metricReaders ? Metrics.layer(() => config.metricReaders) : Layer.effectDiscard(Effect.void);
   return Layer.merge(TracerLive, MetricsLive).pipe(Layer.provideMerge(ResourceLive));
 }));
 //# sourceMappingURL=WebSdk.js.map
\ No newline at end of file
diff --git a/dist/esm/WebSdk.js.map b/dist/esm/WebSdk.js.map
index e4b56daa11ad87dafe5f51c0004ec6e1b1f548ee..5bc5de0c57acba3914872f68ffb90f25601b267e 100644
--- a/dist/esm/WebSdk.js.map
+++ b/dist/esm/WebSdk.js.map
@@ -1 +1 @@
-{"version":3,"file":"WebSdk.js","names":["WebTracerProvider","Effect","Layer","Metrics","Resource","Tracer","layerTracerProvider","processor","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","undefined","addSpanProcessor","ignoreLogged","promise","shutdown","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","TracerLive","spanProcessor","pipe","provide","tracerConfig","effectDiscard","void","MetricsLive","metricReader","merge","provideMerge"],"sources":["../../src/WebSdk.ts"],"sourcesContent":[null],"mappings":"AAOA,SAASA,iBAAiB,QAAQ,8BAA8B;AAChE,OAAO,KAAKC,MAAM,MAAM,eAAe;AAEvC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,OAAO,KAAKC,OAAO,MAAM,cAAc;AACvC,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,OAAO,KAAKC,MAAM,MAAM,aAAa;AAiBrC;;;;AAIA,OAAO,MAAMC,mBAAmB,GAAGA,CACjCC,SAAwB,EACxBC,MAAuC,KAEvCN,KAAK,CAACO,MAAM,CACVJ,MAAM,CAACK,cAAc,EACrBT,MAAM,CAACU,OAAO,CACZP,QAAQ,CAACA,QAAQ,EAChBQ,QAAQ,IACPX,MAAM,CAACY,cAAc,CACnBZ,MAAM,CAACa,IAAI,CAAC,MAAK;EACf,MAAMC,QAAQ,GAAG,IAAIf,iBAAiB,CAAC;IACrC,IAAIQ,MAAM,IAAIQ,SAAS,CAAC;IACxBJ;GACD,CAAC;EACFG,QAAQ,CAACE,gBAAgB,CAACV,SAAS,CAAC;EACpC,OAAOQ,QAAQ;AACjB,CAAC,CAAC,EACDA,QAAQ,IAAKd,MAAM,CAACiB,YAAY,CAACjB,MAAM,CAACkB,OAAO,CAAC,MAAMJ,QAAQ,CAACK,QAAQ,EAAE,CAAC,CAAC,CAC7E,CACJ,CACF;AAEH;;;;AAIA,OAAO,MAAMC,KAAK,GAIhBC,QAAyE,IAEzEpB,KAAK,CAACqB,YAAY,CAChBtB,MAAM,CAACuB,GAAG,CACRvB,MAAM,CAACwB,QAAQ,CAACH,QAAQ,CAAC,GACrBA,QAAwC,GACxCrB,MAAM,CAACa,IAAI,CAACQ,QAAQ,CAAC,EACxBd,MAAM,IAAI;EACT,MAAMkB,YAAY,GAAGtB,QAAQ,CAACiB,KAAK,CAACb,MAAM,CAACI,QAAQ,CAAC;EACpD,MAAMe,UAAU,GAAGnB,MAAM,CAACoB,aAAa,GACrCvB,MAAM,CAACgB,KAAK,CAACQ,IAAI,CAAC3B,KAAK,CAAC4B,OAAO,CAACxB,mBAAmB,CAACE,MAAM,CAACoB,aAAa,EAAEpB,MAAM,CAACuB,YAAY,CAAC,CAAC,CAAC,GAC9F7B,KAAK,CAAC8B,aAAa,CAAC/B,MAAM,CAACgC,IAAI,CAAC;EACpC,MAAMC,WAAW,GAAG1B,MAAM,CAAC2B,YAAY,GACnChC,OAAO,CAACkB,KAAK,CAAC,MAAMb,MAAM,CAAC2B,YAAa,CAAC,GACzCjC,KAAK,CAAC8B,aAAa,CAAC/B,MAAM,CAACgC,IAAI,CAAC;EACpC,OAAO/B,KAAK,CAACkC,KAAK,CAACT,UAAU,EAAEO,WAAW,CAAC,CAACL,IAAI,CAC9C3B,KAAK,CAACmC,YAAY,CAACX,YAAY,CAAC,CACjC;AACH,CAAC,CACF,CACF","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"WebSdk.js","names":["WebTracerProvider","Effect","Layer","Metrics","Resource","Tracer","layerTracerProvider","processors","config","scoped","TracerProvider","flatMap","resource","acquireRelease","sync","provider","undefined","forEach","p","addSpanProcessor","ignoreLogged","promise","shutdown","layer","evaluate","unwrapEffect","map","isEffect","ResourceLive","TracerLive","spanProcessors","pipe","provide","tracerConfig","effectDiscard","void","MetricsLive","metricReaders","merge","provideMerge"],"sources":["../../src/WebSdk.ts"],"sourcesContent":[null],"mappings":"AAOA,SAASA,iBAAiB,QAAQ,8BAA8B;AAEhE,OAAO,KAAKC,MAAM,MAAM,eAAe;AAEvC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,OAAO,KAAKC,OAAO,MAAM,cAAc;AACvC,OAAO,KAAKC,QAAQ,MAAM,eAAe;AACzC,OAAO,KAAKC,MAAM,MAAM,aAAa;AAiBrC;;;;AAIA,OAAO,MAAMC,mBAAmB,GAAGA,CACjCC,UAAgD,EAChDC,MAAuC,KAEvCN,KAAK,CAACO,MAAM,CACVJ,MAAM,CAACK,cAAc,EACrBT,MAAM,CAACU,OAAO,CACZP,QAAQ,CAACA,QAAQ,EAChBQ,QAAQ,IACPX,MAAM,CAACY,cAAc,CACnBZ,MAAM,CAACa,IAAI,CAAC,MAAK;EACf,MAAMC,QAAQ,GAAG,IAAIf,iBAAiB,CAAC;IACrC,IAAIQ,MAAM,IAAIQ,SAAS,CAAC;IACxBJ;GACD,CAAC;EACFL,UAAU,CAACU,OAAO,CAAEC,CAAC,IAAKH,QAAQ,CAACI,gBAAgB,CAACD,CAAC,CAAC,CAAC;EACvD,OAAOH,QAAQ;AACjB,CAAC,CAAC,EACDA,QAAQ,IAAKd,MAAM,CAACmB,YAAY,CAACnB,MAAM,CAACoB,OAAO,CAAC,MAAMN,QAAQ,CAACO,QAAQ,EAAE,CAAC,CAAC,CAC7E,CACJ,CACF;AAEH;;;;AAIA,OAAO,MAAMC,KAAK,GAIhBC,QAAyE,IAEzEtB,KAAK,CAACuB,YAAY,CAChBxB,MAAM,CAACyB,GAAG,CACRzB,MAAM,CAAC0B,QAAQ,CAACH,QAAQ,CAAC,GACrBA,QAAwC,GACxCvB,MAAM,CAACa,IAAI,CAACU,QAAQ,CAAC,EACxBhB,MAAM,IAAI;EACT,MAAMoB,YAAY,GAAGxB,QAAQ,CAACmB,KAAK,CAACf,MAAM,CAACI,QAAQ,CAAC;EACpD,MAAMiB,UAAU,GAAGrB,MAAM,CAACsB,cAAc,GACtCzB,MAAM,CAACkB,KAAK,CAACQ,IAAI,CAAC7B,KAAK,CAAC8B,OAAO,CAAC1B,mBAAmB,CAACE,MAAM,CAACsB,cAAc,EAAEtB,MAAM,CAACyB,YAAY,CAAC,CAAC,CAAC,GAC/F/B,KAAK,CAACgC,aAAa,CAACjC,MAAM,CAACkC,IAAI,CAAC;EACpC,MAAMC,WAAW,GAAG5B,MAAM,CAAC6B,aAAa,GACpClC,OAAO,CAACoB,KAAK,CAAC,MAAMf,MAAM,CAAC6B,aAAc,CAAC,GAC1CnC,KAAK,CAACgC,aAAa,CAACjC,MAAM,CAACkC,IAAI,CAAC;EACpC,OAAOjC,KAAK,CAACoC,KAAK,CAACT,UAAU,EAAEO,WAAW,CAAC,CAACL,IAAI,CAC9C7B,KAAK,CAACqC,YAAY,CAACX,YAAY,CAAC,CACjC;AACH,CAAC,CACF,CACF","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/internal/metrics.js b/dist/esm/internal/metrics.js
index b3af4224b97e0d581684f246c54ffb20b705b117..90e2a2fef46b1d2c90a578abd3229a33a1b63919 100644
--- a/dist/esm/internal/metrics.js
+++ b/dist/esm/internal/metrics.js
@@ -267,10 +267,10 @@ const currentHrTime = () => {
 export const makeProducer = /*#__PURE__*/Effect.map(Resource.Resource, resource => new MetricProducerImpl(resource));
 /** @internal */
 export const registerProducer = (self, metricReader) => Effect.acquireRelease(Effect.sync(() => {
-  const reader = metricReader();
-  reader.setMetricProducer(self);
-  return reader;
-}), reader => Effect.ignoreLogged(Effect.promise(() => reader.shutdown())));
+  const readers = metricReader();
+  readers.forEach(_ => _.setMetricProducer(self));
+  return readers;
+}), readers => Effect.ignoreLogged(Effect.promise(() => Promise.all(readers.map(_ => _.shutdown())))));
 /** @internal */
 export const layer = evaluate => Layer.scopedDiscard(Effect.flatMap(makeProducer, producer => registerProducer(producer, evaluate)));
 //# sourceMappingURL=metrics.js.map
\ No newline at end of file
diff --git a/dist/esm/internal/metrics.js.map b/dist/esm/internal/metrics.js.map
index f870edcf2be73cd0cd92369c19b62c312b4c750a..e945c7fb72d1a1833aafd63cd149e38ed835bc83 100644
--- a/dist/esm/internal/metrics.js.map
+++ b/dist/esm/internal/metrics.js.map
@@ -1 +1 @@
-{"version":3,"file":"metrics.js","names":["ValueType","AggregationTemporality","DataPointType","InstrumentType","Arr","Effect","Layer","Metric","MetricKeyType","MetricState","Option","Resource","sdkName","MetricProducerImpl","resource","constructor","startTimes","Map","startTimeFor","name","hrTime","has","get","set","collect","_options","snapshot","unsafeSnapshot","hrTimeNow","currentHrTime","metricData","metricDataByName","addMetricData","data","push","descriptor","i","len","length","metricKey","metricState","attributes","reduce","tags","acc","label","key","value","descriptorFromKey","startTime","isCounterState","dataPoint","endTime","Number","count","dataPoints","dataPointType","SUM","isMonotonic","type","COUNTER","aggregationTemporality","CUMULATIVE","isGaugeState","GAUGE","isHistogramState","size","buckets","boundaries","allocate","counts","prev","boundary","min","max","sum","HISTOGRAM","isFrequencyState","freqKey","occurrences","isSummaryState","quantile","quantiles","toString","_tag","countDataPoint","sumDataPoint","descriptorMeta","unit","valueType","INT","DOUBLE","Promise","resolve","resourceMetrics","scopeMetrics","scope","metrics","errors","suffix","description","getOrElse","time_unit","instrumentTypeFromKey","keyType","bigint","isHistogramKey","isGaugeKey","OBSERVABLE_GAUGE","isFrequencyKey","isCounterKey","incremental","UP_DOWN_COUNTER","now","Date","Math","floor","makeProducer","map","registerProducer","self","metricReader","acquireRelease","sync","reader","setMetricProducer","ignoreLogged","promise","shutdown","layer","evaluate","scopedDiscard","flatMap","producer"],"sources":["../../../src/internal/metrics.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"metrics.js","names":["ValueType","AggregationTemporality","DataPointType","InstrumentType","Arr","Effect","Layer","Metric","MetricKeyType","MetricState","Option","Resource","sdkName","MetricProducerImpl","resource","constructor","startTimes","Map","startTimeFor","name","hrTime","has","get","set","collect","_options","snapshot","unsafeSnapshot","hrTimeNow","currentHrTime","metricData","metricDataByName","addMetricData","data","push","descriptor","i","len","length","metricKey","metricState","attributes","reduce","tags","acc","label","key","value","descriptorFromKey","startTime","isCounterState","dataPoint","endTime","Number","count","dataPoints","dataPointType","SUM","isMonotonic","type","COUNTER","aggregationTemporality","CUMULATIVE","isGaugeState","GAUGE","isHistogramState","size","buckets","boundaries","allocate","counts","prev","boundary","min","max","sum","HISTOGRAM","isFrequencyState","freqKey","occurrences","isSummaryState","quantile","quantiles","toString","_tag","countDataPoint","sumDataPoint","descriptorMeta","unit","valueType","INT","DOUBLE","Promise","resolve","resourceMetrics","scopeMetrics","scope","metrics","errors","suffix","description","getOrElse","time_unit","instrumentTypeFromKey","keyType","bigint","isHistogramKey","isGaugeKey","OBSERVABLE_GAUGE","isFrequencyKey","isCounterKey","incremental","UP_DOWN_COUNTER","now","Date","Math","floor","makeProducer","map","registerProducer","self","metricReader","acquireRelease","sync","readers","forEach","_","setMetricProducer","ignoreLogged","promise","all","shutdown","layer","evaluate","scopedDiscard","flatMap","producer"],"sources":["../../../src/internal/metrics.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/dist/esm/internal/tracer.js b/dist/esm/internal/tracer.js
index 65c1051052d347932fc827321a7a376207c41f69..94b6cbf9ee3928a6f3c9e3302647968f1e1bdf3a 100644
--- a/dist/esm/internal/tracer.js
+++ b/dist/esm/internal/tracer.js
@@ -8,12 +8,20 @@ import * as Option from "effect/Option";
 import * as EffectTracer from "effect/Tracer";
 import { Resource } from "../Resource.js";
 const OtelSpanTypeId = /*#__PURE__*/Symbol.for("@effect/opentelemetry/Tracer/OtelSpan");
+const kindMap = {
+  "internal": OtelApi.SpanKind.INTERNAL,
+  "client": OtelApi.SpanKind.CLIENT,
+  "server": OtelApi.SpanKind.SERVER,
+  "producer": OtelApi.SpanKind.PRODUCER,
+  "consumer": OtelApi.SpanKind.CONSUMER
+};
 /** @internal */
 export class OtelSpan {
   name;
   parent;
   context;
   links;
+  kind;
   [OtelSpanTypeId];
   _tag = "Span";
   span;
@@ -22,11 +30,12 @@ export class OtelSpan {
   attributes = new Map();
   sampled;
   status;
-  constructor(contextApi, tracer, name, parent, context, links, startTime) {
+  constructor(contextApi, tracer, name, parent, context, links, startTime, kind) {
     this.name = name;
     this.parent = parent;
     this.context = context;
     this.links = links;
+    this.kind = kind;
     this[OtelSpanTypeId] = OtelSpanTypeId;
     const active = contextApi.active();
     this.span = tracer.startSpan(name, {
@@ -34,7 +43,8 @@ export class OtelSpan {
       links: links.length > 0 ? links.map(link => ({
         context: makeSpanContext(link.span),
         attributes: recordToAttributes(link.attributes)
-      })) : undefined
+      })) : undefined,
+      kind: kindMap[this.kind]
     }, parent._tag === "Some" ? populateContext(active, parent.value, context) : OtelApi.trace.deleteSpan(active));
     const spanContext = this.span.spanContext();
     this.spanId = spanContext.spanId;
@@ -87,8 +97,8 @@ export const TracerProvider = /*#__PURE__*/Context.GenericTag("@effect/opentelem
 export const Tracer = /*#__PURE__*/Context.GenericTag("@effect/opentelemetry/Tracer/Tracer");
 /** @internal */
 export const make = /*#__PURE__*/Effect.map(Tracer, tracer => EffectTracer.make({
-  span(name, parent, context, links, startTime) {
-    return new OtelSpan(OtelApi.context, tracer, name, parent, context, links, startTime);
+  span(name, parent, context, links, startTime, kind) {
+    return new OtelSpan(OtelApi.context, tracer, name, parent, context, links, startTime, kind);
   },
   context(execution, fiber) {
     const currentSpan = fiber.getFiberRef(FiberRef.currentContext).unsafeMap.get(EffectTracer.ParentSpan.key);
diff --git a/dist/esm/internal/tracer.js.map b/dist/esm/internal/tracer.js.map
index 567a4f21cfc1664902ef6e4c4d47a2a4a1a87c38..ea99afdd626c0263256a1da6b75e6695490b8e27 100644
--- a/dist/esm/internal/tracer.js.map
+++ b/dist/esm/internal/tracer.js.map
@@ -1 +1 @@
-{"version":3,"file":"tracer.js","names":["OtelApi","Cause","Context","Effect","FiberRef","Layer","Option","EffectTracer","Resource","OtelSpanTypeId","Symbol","for","OtelSpan","name","parent","context","links","_tag","span","spanId","traceId","attributes","Map","sampled","status","constructor","contextApi","tracer","startTime","active","startSpan","nanosToHrTime","length","map","link","makeSpanContext","recordToAttributes","undefined","populateContext","value","trace","deleteSpan","spanContext","traceFlags","TraceFlags","SAMPLED","attribute","key","setAttribute","unknownToAttributeValue","set","end","endTime","exit","setStatus","code","SpanStatusCode","OK","isInterruptedOnly","cause","message","pretty","ERROR","event","addEvent","TracerProvider","GenericTag","Tracer","make","execution","fiber","currentSpan","getFiberRef","currentContext","unsafeMap","get","ParentSpan","with","traceFlagsTag","traceStateTag","makeExternalSpan","options","empty","add","traceState","match","createTraceState","onNone","onSome","currentOtelSpan","flatMap","succeed","fail","NoSuchElementException","layerGlobalProvider","sync","getTracerProvider","layerTracer","effect","zip","resource","provider","getTracer","layerGlobalTracer","pipe","provide","layerGlobal","unwrapEffect","setTracer","layer","bigint1e9","timestamp","Number","liftThrowable","otelContext","setSpan","setSpanContext","isRemote","getOrElse","extractTraceTag","getOption","getOrUndefined","tag","orElse","Object","entries","reduce","acc","objectToAttribute","JSON","stringify","String"],"sources":["../../../src/internal/tracer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
+{"version":3,"file":"tracer.js","names":["OtelApi","Cause","Context","Effect","FiberRef","Layer","Option","EffectTracer","Resource","OtelSpanTypeId","Symbol","for","kindMap","SpanKind","INTERNAL","CLIENT","SERVER","PRODUCER","CONSUMER","OtelSpan","name","parent","context","links","kind","_tag","span","spanId","traceId","attributes","Map","sampled","status","constructor","contextApi","tracer","startTime","active","startSpan","nanosToHrTime","length","map","link","makeSpanContext","recordToAttributes","undefined","populateContext","value","trace","deleteSpan","spanContext","traceFlags","TraceFlags","SAMPLED","attribute","key","setAttribute","unknownToAttributeValue","set","end","endTime","exit","setStatus","code","SpanStatusCode","OK","isInterruptedOnly","cause","message","pretty","ERROR","event","addEvent","TracerProvider","GenericTag","Tracer","make","execution","fiber","currentSpan","getFiberRef","currentContext","unsafeMap","get","ParentSpan","with","traceFlagsTag","traceStateTag","makeExternalSpan","options","empty","add","traceState","match","createTraceState","onNone","onSome","currentOtelSpan","flatMap","succeed","fail","NoSuchElementException","layerGlobalProvider","sync","getTracerProvider","layerTracer","effect","zip","resource","provider","getTracer","layerGlobalTracer","pipe","provide","layerGlobal","unwrapEffect","setTracer","layer","bigint1e9","timestamp","Number","liftThrowable","otelContext","setSpan","setSpanContext","isRemote","getOrElse","extractTraceTag","getOption","getOrUndefined","tag","orElse","Object","entries","reduce","acc","objectToAttribute","JSON","stringify","String"],"sources":["../../../src/internal/tracer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}
\ No newline at end of file
diff --git a/src/Metrics.ts b/src/Metrics.ts
index 4d565f7eb8f3e41632a2539512e2e328272afac3..dac8cab07e475e9ff39e6d0d9f2e58e0a04759ad 100644
--- a/src/Metrics.ts
+++ b/src/Metrics.ts
@@ -2,6 +2,7 @@
  * @since 1.0.0
  */
 import type { MetricProducer, MetricReader } from "@opentelemetry/sdk-metrics"
+import type { NonEmptyReadonlyArray } from "effect/Array"
 import type * as Effect from "effect/Effect"
 import type { LazyArg } from "effect/Function"
 import type { Layer } from "effect/Layer"
@@ -21,11 +22,12 @@ export const makeProducer: Effect.Effect<MetricProducer, never, Resource> = inte
  */
 export const registerProducer: (
   self: MetricProducer,
-  metricReader: LazyArg<MetricReader>
-) => Effect.Effect<MetricReader, never, Scope.Scope> = internal.registerProducer
+  metricReaders: LazyArg<NonEmptyReadonlyArray<MetricReader>>
+) => Effect.Effect<NonEmptyReadonlyArray<MetricReader>, never, Scope.Scope> = internal.registerProducer
 
 /**
  * @since 1.0.0
  * @category layers
  */
-export const layer: (evaluate: LazyArg<MetricReader>) => Layer<never, never, Resource> = internal.layer
+export const layer: (evaluate: LazyArg<NonEmptyReadonlyArray<MetricReader>>) => Layer<never, never, Resource> =
+  internal.layer
diff --git a/src/NodeSdk.ts b/src/NodeSdk.ts
index 43970d342b7ec87d8930b1a589e839fba4b6dca7..3e922b7700b7c091f5195ef24ad626a557883b45 100644
--- a/src/NodeSdk.ts
+++ b/src/NodeSdk.ts
@@ -6,6 +6,7 @@ import type * as Resources from "@opentelemetry/resources"
 import type { MetricReader } from "@opentelemetry/sdk-metrics"
 import type { SpanProcessor, TracerConfig } from "@opentelemetry/sdk-trace-base"
 import { NodeTracerProvider } from "@opentelemetry/sdk-trace-node"
+import type { NonEmptyReadonlyArray } from "effect/Array"
 import * as Effect from "effect/Effect"
 import type { LazyArg } from "effect/Function"
 import * as Layer from "effect/Layer"
@@ -18,7 +19,7 @@ import * as Tracer from "./Tracer.js"
  * @category model
  */
 export interface Configuration {
-  readonly spanProcessor?: SpanProcessor | undefined
+  readonly spanProcessors?: NonEmptyReadonlyArray<SpanProcessor> | undefined
   readonly tracerConfig?: Omit<TracerConfig, "resource"> | undefined
   readonly metricReader?: MetricReader | undefined
   readonly resource?: {
@@ -33,7 +34,7 @@ export interface Configuration {
  * @category layers
  */
 export const layerTracerProvider = (
-  processor: SpanProcessor,
+  processors: ReadonlyArray<SpanProcessor>,
   config?: Omit<TracerConfig, "resource">
 ): Layer.Layer<TracerProvider, never, Resource.Resource> =>
   Layer.scoped(
@@ -47,7 +48,7 @@ export const layerTracerProvider = (
               ...(config ?? undefined),
               resource
             })
-            provider.addSpanProcessor(processor)
+            processors.forEach((p) => provider.addSpanProcessor(p))
             return provider
           }),
           (provider) => Effect.ignoreLogged(Effect.promise(() => provider.shutdown()))
@@ -74,13 +75,13 @@ export const layer: {
         const ResourceLive = config.resource === undefined
           ? Resource.layerFromEnv()
           : Resource.layer(config.resource)
-        const TracerLive = config.spanProcessor ?
+        const TracerLive = config.spanProcessors ?
           Tracer.layer.pipe(
-            Layer.provide(layerTracerProvider(config.spanProcessor, config.tracerConfig))
+            Layer.provide(layerTracerProvider(config.spanProcessors, config.tracerConfig))
           )
           : Layer.empty
         const MetricsLive = config.metricReader
-          ? Metrics.layer(() => config.metricReader!)
+          ? Metrics.layer(() => [config.metricReader!])
           : Layer.empty
         return Layer.merge(TracerLive, MetricsLive).pipe(
           Layer.provideMerge(ResourceLive)
diff --git a/src/WebSdk.ts b/src/WebSdk.ts
index 231f86ab05da314edf44a36da72dcf45f09a55e1..f2acf415368f5cbab689607eec92f2da6f271830 100644
--- a/src/WebSdk.ts
+++ b/src/WebSdk.ts
@@ -6,6 +6,7 @@ import type * as Resources from "@opentelemetry/resources"
 import type { MetricReader } from "@opentelemetry/sdk-metrics"
 import type { SpanProcessor, TracerConfig } from "@opentelemetry/sdk-trace-base"
 import { WebTracerProvider } from "@opentelemetry/sdk-trace-web"
+import type { NonEmptyReadonlyArray } from "effect/Array"
 import * as Effect from "effect/Effect"
 import type { LazyArg } from "effect/Function"
 import * as Layer from "effect/Layer"
@@ -18,9 +19,9 @@ import * as Tracer from "./Tracer.js"
  * @category model
  */
 export interface Configuration {
-  readonly spanProcessor?: SpanProcessor
+  readonly spanProcessors?: NonEmptyReadonlyArray<SpanProcessor>
   readonly tracerConfig?: Omit<TracerConfig, "resource">
-  readonly metricReader?: MetricReader
+  readonly metricReaders?: NonEmptyReadonlyArray<MetricReader>
   readonly resource: {
     readonly serviceName: string
     readonly serviceVersion?: string
@@ -33,7 +34,7 @@ export interface Configuration {
  * @category layers
  */
 export const layerTracerProvider = (
-  processor: SpanProcessor,
+  processors: NonEmptyReadonlyArray<SpanProcessor>,
   config?: Omit<TracerConfig, "resource">
 ): Layer.Layer<TracerProvider, never, Resource.Resource> =>
   Layer.scoped(
@@ -47,7 +48,7 @@ export const layerTracerProvider = (
               ...(config ?? undefined),
               resource
             })
-            provider.addSpanProcessor(processor)
+            processors.forEach((p) => provider.addSpanProcessor(p))
             return provider
           }),
           (provider) => Effect.ignoreLogged(Effect.promise(() => provider.shutdown()))
@@ -72,11 +73,11 @@ export const layer: {
         : Effect.sync(evaluate),
       (config) => {
         const ResourceLive = Resource.layer(config.resource)
-        const TracerLive = config.spanProcessor ?
-          Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessor, config.tracerConfig)))
+        const TracerLive = config.spanProcessors ?
+          Tracer.layer.pipe(Layer.provide(layerTracerProvider(config.spanProcessors, config.tracerConfig)))
           : Layer.effectDiscard(Effect.void)
-        const MetricsLive = config.metricReader
-          ? Metrics.layer(() => config.metricReader!)
+        const MetricsLive = config.metricReaders
+          ? Metrics.layer(() => config.metricReaders!)
           : Layer.effectDiscard(Effect.void)
         return Layer.merge(TracerLive, MetricsLive).pipe(
           Layer.provideMerge(ResourceLive)
diff --git a/src/internal/metrics.ts b/src/internal/metrics.ts
index 2f883cf3896c58ba515dd1c4a069846dde54b6c9..844e143669e3a984a44d40f4cfead4170a0d70d5 100644
--- a/src/internal/metrics.ts
+++ b/src/internal/metrics.ts
@@ -290,18 +290,21 @@ export const makeProducer = Effect.map(
 )
 
 /** @internal */
-export const registerProducer = (self: MetricProducer, metricReader: LazyArg<MetricReader>) =>
+export const registerProducer = (
+  self: MetricProducer,
+  metricReader: LazyArg<Arr.NonEmptyReadonlyArray<MetricReader>>
+) =>
   Effect.acquireRelease(
     Effect.sync(() => {
-      const reader = metricReader()
-      reader.setMetricProducer(self)
-      return reader
+      const readers = metricReader()
+      readers.forEach((_) => _.setMetricProducer(self))
+      return readers
     }),
-    (reader) => Effect.ignoreLogged(Effect.promise(() => reader.shutdown()))
+    (readers) => Effect.ignoreLogged(Effect.promise(() => Promise.all(readers.map((_) => _.shutdown()))))
   )
 
 /** @internal */
-export const layer = (evaluate: LazyArg<MetricReader>) =>
+export const layer = (evaluate: LazyArg<Arr.NonEmptyReadonlyArray<MetricReader>>) =>
   Layer.scopedDiscard(Effect.flatMap(
     makeProducer,
     (producer) => registerProducer(producer, evaluate)
diff --git a/src/internal/tracer.ts b/src/internal/tracer.ts
index a0485ee10d8eab44750b62ad9c9a552c4b458000..ecccf7d9539b117bde99b1007ac7ef94d3fd1586 100644
--- a/src/internal/tracer.ts
+++ b/src/internal/tracer.ts
@@ -11,6 +11,14 @@ import { Resource } from "../Resource.js"
 
 const OtelSpanTypeId = Symbol.for("@effect/opentelemetry/Tracer/OtelSpan")
 
+const kindMap = {
+  "internal": OtelApi.SpanKind.INTERNAL,
+  "client": OtelApi.SpanKind.CLIENT,
+  "server": OtelApi.SpanKind.SERVER,
+  "producer": OtelApi.SpanKind.PRODUCER,
+  "consumer": OtelApi.SpanKind.CONSUMER
+}
+
 /** @internal */
 export class OtelSpan implements EffectTracer.Span {
   readonly [OtelSpanTypeId]: typeof OtelSpanTypeId
@@ -30,7 +38,8 @@ export class OtelSpan implements EffectTracer.Span {
     readonly parent: Option.Option<EffectTracer.AnySpan>,
     readonly context: Context.Context<never>,
     readonly links: ReadonlyArray<EffectTracer.SpanLink>,
-    startTime: bigint
+    startTime: bigint,
+    readonly kind: EffectTracer.SpanKind
   ) {
     this[OtelSpanTypeId] = OtelSpanTypeId
     const active = contextApi.active()
@@ -43,7 +52,8 @@ export class OtelSpan implements EffectTracer.Span {
             context: makeSpanContext(link.span),
             attributes: recordToAttributes(link.attributes)
           }))
-          : undefined as any
+          : undefined as any,
+        kind: kindMap[this.kind]
       },
       parent._tag === "Some"
         ? populateContext(active, parent.value, context)
@@ -112,7 +122,7 @@ export const Tracer = Context.GenericTag<OtelApi.Tracer>("@effect/opentelemetry/
 /** @internal */
 export const make = Effect.map(Tracer, (tracer) =>
   EffectTracer.make({
-    span(name, parent, context, links, startTime) {
+    span(name, parent, context, links, startTime, kind) {
       return new OtelSpan(
         OtelApi.context,
         tracer,
@@ -120,7 +130,8 @@ export const make = Effect.map(Tracer, (tracer) =>
         parent,
         context,
         links,
-        startTime
+        startTime,
+        kind
       )
     },
     context(execution, fiber) {
